/*!
	jWidget UI 0.5.1
	
	https://github.com/enepomnyaschih/jwidget/wiki
	
	Copyright (C) 2013 Egor Nepomnyaschih
	
	This program is free software: you can redistribute it and/or modify
	it under the terms of the GNU Lesser General Public License as published by
	the Free Software Foundation, either version 3 of the License, or
	(at your option) any later version.
	
	This program is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU Lesser General Public License for more details.
	
	You should have received a copy of the GNU Lesser General Public License
	along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/
JW.UI={template:function(a,b){if(a.prototype.Templates&&a.prototype.Templates.componentCls==a){JW.apply(a.prototype.Templates.prototype,b)}else{a.prototype.Templates=(a.superclass.Templates||JW.Class).extend(b);a.prototype.Templates.componentCls=a;a.prototype.templates=new a.prototype.Templates()}},isElement:function(a){return a instanceof jQuery.fn.init},preventDefault:function(a){a.preventDefault()}};jQuery(function(){JW.UI.windowEl=jQuery(window);JW.UI.bodyEl=jQuery(document.body)});JW.apply(jQuery.fn,{insert:function(b,a){if(!JW.isSet(a)){this.append(b)}else{if(a==0){this.prepend(b)}else{jQuery(this.children()[a-1]).after(b)}}},replaceBy:function(c,b){var d=b?this.attr("id"):null,a=b?this.attr("class"):null;c=jQuery(c);this.after(c);this.detach();if(d){c.attr("id",d)}if(a){c.addClass(a)}}});JW.UI.Browsers=(function(){ua=navigator.userAgent.toLowerCase();function y(H){return H.test(ua)}var j=document.compatMode=="CSS1Compat",l=document.documentMode,C=y(/opera/),n=C&&y(/version\/10\.5/),g=y(/\bchrome\b/),t=y(/webkit/),x=!g&&y(/safari/),f=x&&y(/applewebkit\/4/),c=x&&y(/version\/3/),G=x&&y(/version\/4/),E=x&&y(/version\/5/),s=!C&&y(/msie/),q=s&&(y(/msie 7/)||l==7),p=s&&(y(/msie 8/)&&l!=7&&l!=9||l==8),o=s&&(y(/msie 9/)&&l!=7&&l!=8||l==9),r=s&&y(/msie 6/),m=!t&&y(/gecko/),e=m&&y(/rv:1\.8/),b=m&&y(/rv:1\.9/),F=m&&y(/rv:2\.0/),D=m&&y(/rv:5\./),a=b&&y(/rv:1\.9\.0/),B=b&&y(/rv:1\.9\.1/),A=b&&y(/rv:1\.9\.2/),w=s&&!j,z=y(/windows|win32/),i=y(/macintosh|mac os x/),h=y(/adobeair/),k=y(/linux/),v=y(/ipad/),d=/^https/i.test(window.location.protocol);var u=!(t||v);return{isStrict:j,isOpera:C,isOpera10_5:n,isChrome:g,isWebKit:t,isSafari:x,isSafari2:f,isSafari3:c,isSafari4:G,isSafari5:E,isIE:s,isIE7:q,isIE8:p,isIE9:o,isIE6:r,isGecko:m,isGecko2:e,isGecko3:b,isGecko4:F,isGecko5:D,isFF3_0:a,isFF3_5:B,isFF3_6:A,isBorderBox:w,isWindows:z,isMac:i,isAir:h,isLinux:k,isIPad:v,isSecure:d,isPaddingWideTd:u}})();JW.UI.Component=function(a){JW.UI.Component._super.call(this);a=a||{};this.rootClass=a.rootClass;this.template=a.template;this.parent=null;this.wasAfterAppend=false;this.destroyed=false;this.el=null;this.replacedEl=null;this.children=null;this.allChildren=null;this._elements=null;this._childMapper=null;this._arrays=null},JW.extend(JW.UI.Component,JW.Class,{destroy:function(){if(this.parent){throw new Error("JW.UI.Component.destroy must be used for root and detached components only")}if(this.destroyed){return}this.destroyed=true;if(this.el){this.el.remove();JW.Set.eachByMethod(this._arrays,"destroy");this._arrays=null;this.destroyComponent();this._childMapper.destroy();this._childMapper=null;this.children.eachByMethod("destroy");this.children.destroy();this.children=null}this.allChildren=null;this._elements=null;this.el=null;this._super()},beforeRender:function(){},renderComponent:function(){},afterAppend:function(){},destroyComponent:function(){},render:function(h){if(this.el){return}this.replacedEl=h;this.el=jQuery(this.template||this.templates.main);this._elements={};this.allChildren={};this.children=new JW.ObservableMap();this._arrays={};this.rootClass=this.rootClass||this.el.attr("jwclass");if(this.rootClass){this.el.removeAttr("jwclass");this.el.addClass(this.rootClass)}var f=this.el.find("[jwid]");for(var c=0;c<f.length;++c){var e=jQuery(f[c]);var d=e.attr("jwid");this._elements[d]=e;e.removeAttr("jwid");e.addClass(this.getElementClass(d))}this._childMapper=this.children.createMapper({source:this.children,createItem:function(k,i){return new JW.UI.Component.Child(this,k,i)},destroyItem:function(i){i.destroy()},scope:this});this.beforeRender();var a=JW.apply({},this._elements);for(var d in a){var e=a[d];var b=JW.String.camel(d);var g="render"+JW.String.capitalize(b);if(typeof this[g]==="function"){var j=this[g](e);if(j instanceof JW.UI.Component){this.children.set(j,d)}else{if((j instanceof JW.Array)||(j instanceof JW.ObservableArray)){this.addArray(j,d)}else{if(j===false){this.removeElement(d)}}}}}this.renderComponent()},renderTo:function(a){this.render();jQuery(a).insert(this.el);this._afterAppend()},renderAs:function(a){this.render(a);jQuery(a).replaceBy(this.el,true);this._afterAppend()},remove:function(){if(this.parent){throw new Error("JW.UI.Component.remove must be used for root components only")}this.el.detach()},getElement:function(a){return this._elements[a]},setElement:function(a,b){this._elements[b]=a},getElementClass:function(a){return JW.Array.map(JW.Array.filter([this.rootClass,a],JW.isSet),JW.String.hyphen).join("-")},removeElement:function(b){var a=this._elements[b];if(!a){return}a.remove();delete this._elements[b]},addArray:function(b,a){return new JW.UI.Component.Array(this,b,this._getElement(a))},_afterAppend:function(){if(this.wasAfterAppend||!this.el){return}if(this.parent&&!this.parent.wasAfterAppend){return}if(!this.parent&&!this.el.parents("body").length){return}this.wasAfterAppend=true;this.afterAppend();JW.Set.eachByMethod(this.allChildren,"_afterAppend")},_initChild:function(b,a){b.render(a);b.parent=this;JW.Set.add(this.allChildren,b)},_doneChild:function(a){JW.Set.remove(this.allChildren,a);a.parent=null},_getElement:function(a){return(typeof a==="string")?this.getElement(a):(a||this.el)}});JW.UI.template(JW.UI.Component,{main:"<div />"});JW.UI.Component.EventParams=function(a){JW.UI.Component.EventParams._super.call(this,a)};JW.extend(JW.UI.Component.EventParams,JW.EventParams,{});JW.UI.Component.Array=function(b,c,a){JW.UI.Component.Array._super.call(this);this.parent=b;JW.Set.add(b._arrays,this);this._mapper=c.createMapper({createItem:function(d){this.parent._initChild(d);return d},destroyItem:function(d){this.parent._doneChild(d)},scope:this});this._inserter=new JW.UI.Inserter(this._mapper.target,a)};JW.extend(JW.UI.Component.Array,JW.Class,{destroy:function(){this._inserter.destroy();this._mapper.destroy();JW.Set.remove(this.parent._arrays,this);this._super()}});JW.UI.Component.Child=function(b,c,a){JW.UI.Component.Child._super.call(this);this.parent=b;this.child=c;this.name=a;this._el=this.parent.getElement(a);this.parent._initChild(this.child,this._el);this.parent._elements[a]=this.child.el;this._el.replaceBy(this.child.el,true);this.child._afterAppend()};JW.extend(JW.UI.Component.Child,JW.Class,{destroy:function(){if(this.parent._elements[this.name]===this.child.el){this.parent._elements[this.name]=this._el}this.child.el.replaceBy(this._el);this.parent._doneChild(this.child);this._super()}});JW.UI.Inserter=function(b,a){JW.UI.Inserter._super.call(this);this.el=a;this._inserter=b.createInserter({addItem:this._addItem,removeItem:this._removeItem,scope:this})};JW.extend(JW.UI.Inserter,JW.Class,{destroy:function(){this._inserter.destroy();this._super()},_addItem:function(b,a){this.el.insert(b.el,a);b._afterAppend()},_removeItem:function(a,b){b.el.detach()}});JW.UI.Params={};(function(){if(!location.search.length){return}var c=location.search.substr(1).split("&");for(var a=0;a<c.length;++a){var b=c[a].split("=");if(b.length!=2){continue}JW.UI.Params[b[0]]=decodeURIComponent(b[1]).replace(/\+/g," ")}})();JW.UI.preloadImage=function(c,d,a){var b=new Image();jQuery(b).load(function(){if(typeof d==="function"){d.call(a,b)}}).error(function(){if(typeof d==="function"){d.call(a)}}).attr("src",c)
};