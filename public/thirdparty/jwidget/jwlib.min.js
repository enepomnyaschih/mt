/*!
    jWidget Lib 2.0

    http://enepomnyaschih.github.io/jwidget/#!/guide/home

    Copyright (C) 2015 Egor Nepomnyaschih

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Lesser General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/
var _JW;(function(a){a.A=Array;a.S=String})(_JW||(_JW={}));var JW;(function(O){function n(T){return T===undefined}O.isUndefined=n;function q(T){return T!==undefined}O.isDefined=q;function F(T){return T===null}O.isNull=F;function w(T){return T!==null}O.isNotNull=w;function A(T){return T!=null}O.isSet=A;function g(T){return T==null}O.isNotSet=g;function x(T){return !T}O.isBlank=x;function c(T){return Boolean(T)}O.isNotBlank=c;function L(T){return(typeof T==="number")&&Math.round(T)===T}O.isInt=L;function R(T){return typeof T==="number"}O.isNumber=R;function i(T){return typeof T==="string"}O.isString=i;function y(T){return typeof T==="boolean"}O.isBoolean=y;function k(T){return typeof T==="function"}O.isFunction=k;function t(T){return Object.prototype.toString.apply(T)==="[object Array]"}O.isArray=t;function D(T){return Object.prototype.toString.apply(T)==="[object Object]"}O.isObject=D;function e(T){return Object.prototype.toString.apply(T)==="[object RegExp]"}O.isRegExp=e;function s(T){return Object.prototype.toString.apply(T)==="[object Date]"}O.isDate=s;function m(U,T){return(U!==undefined)?U:T}O.def=m;function N(U,T){return(U!=null)?U:T}O.defn=N;function Q(Y){var T=[];for(var X=1;X<arguments.length;X++){T[X-1]=arguments[X]}for(var V=0;V<T.length;++V){var W=T[V];if(!W){continue}for(var U in W){if(W[U]!==undefined){Y[U]=W[U]}}}return Y}O.apply=Q;function H(Y){var T=[];for(var X=1;X<arguments.length;X++){T[X-1]=arguments[X]}for(var V=0;V<T.length;++V){var W=T[V];if(!W){continue}for(var U in W){if((W[U]!==undefined)&&(Y[U]===undefined)){Y[U]=W[U]}}}return Y}O.applyIf=H;function K(Y){var T=[];for(var X=1;X<arguments.length;X++){T[X-1]=arguments[X]}for(var V=0;V<T.length;++V){var W=T[V];if(!W){continue}for(var U in W){if((W[U]!==undefined)&&(Y[U]==null)){Y[U]=W[U]}}}return Y}O.applyIfn=K;function C(V){var T={};for(var U in V){if(V[U]!==undefined){T[U]=V[U]}}return T}O.clean=C;function B(V){var T={};for(var U in V){if(V[U]!=null){T[U]=V[U]}}return T}O.cleann=B;function o(T,U,X){if(U===undefined){U=0}if(X===undefined){X=T.length-U}var W=[];for(var V=0;V<X;++V){W.push(T[U+V])}return W}O.toArray=o;function p(){var T=[];for(var U=0;U<arguments.length;U++){T[U-0]=arguments[U]}}O.emptyFn=p;function E(U,V,T){if(typeof U==="boolean"&&typeof V==="boolean"){return U?(V?0:1):(V?-1:0)}if(t(U)&&t(V)){return O.Array.cmp(U,V,T)}if(T){if(typeof U==="string"){U=U.toLowerCase()}if(typeof V==="string"){V=V.toLowerCase()}}if(U>V){return 1}if(U<V){return -1}return 0}O.cmp=E;function P(T,U){return E(T,U,false)}O.cmpCaseSensitive=P;function b(T,U){return E(T,U,true)}O.cmpCaseInsensitive=b;function J(X,W,V){if(!W){return O.def(X,V)}if(typeof W==="string"){W=W.split(".")}W=O.Array.filter(W,function(Y){return(Y!=null)&&(Y!=="")});for(var U=0,T=W.length;U<T;++U){if(!X){return V}X=X[W[U]]}return O.def(X,V)}O.get=J;function u(Y,W,X){if(!X){return}if(typeof X==="string"){X=X.split(".")}X=O.Array.filter(X,function(Z){return(Z!=null)&&(Z!=="")});for(var V=0,T=X.length-1;V<T;++V){var U=X[V];Y[U]=Y[U]||{};Y=Y[U]}Y[O.Array.getLast(X)]=W}O.set=u;function v(T){if(T){return T._iid}}O.iid=v;function S(T){return(T&&typeof T==="object")?T._iid:T}O.iidForcibly=S;function G(T){if(T){T.destroy()}}O.destroy=G;function a(T){if(T&&typeof T.destroy==="function"){T.destroy()}}O.destroyForcibly=a;function d(U,T){return U-T*Math.floor(U/T)}O.mod=d;function j(U,T){return U-T*Math.round(U/T)}O.smod=j;function M(T){return !T?0:T>0?1:-1}O.sgn=M;function I(T){return T>=0?1:-1}O.sgnnz=I;function r(U,T){return function(){return U.apply(T,arguments)}}O.inScope=r;function z(T){return function(U){return J(U,T)}}O.byField=z;function h(U,T){return function(V){return J(V,U)===T}}O.byValue=h;function l(U,T){T=T||[];return function(V){return V[U].apply(V,T)}}O.byMethod=l;O.UPDATE=1;O.WATCH=2;O.TWOWAY=3;(function(T){T[T.UPDATE=1]="UPDATE";T[T.WATCH=2]="WATCH";T[T.TWOWAY=3]="TWOWAY"})(O.Binding||(O.Binding={}));var f=O.Binding})(JW||(JW={}));var JW;(function(b){var a=(function(){function c(){this._ownagePool=[];this._iid=++c._lastIid}c.prototype.own=function(d){this._ownagePool.push(d);return d};c.prototype.destroy=function(){var e=this._ownagePool;this._ownagePool=null;for(var d=e.length-1;d>=0;--d){e[d].destroy()}this.destroyObject()};c.prototype.destroyObject=function(){};c._lastIid=0;return c})();b.Class=a})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(){d.apply(this,arguments);this._attachments=null}c.prototype.destroyObject=function(){this.purge();d.prototype.destroyObject.call(this)};c.prototype.bind=function(f,e){if(this._attachments===null){this._attachments={}}var g=new b.EventAttachment(this,f,e);this._attachments[g._iid]=g;return g};c.prototype.unbind=function(e){if(this._attachments!==null){delete this._attachments[e._iid]}};c.prototype.purge=function(){this._attachments=null};c.prototype.trigger=function(g){if(this._attachments===null){return}for(var e in this._attachments){var f=this._attachments[e];f.handler.call(f.scope||f,g)}};c.prototype.hasAttachments=function(){return(this._attachments===null)||!b.Map.isEmpty(this._attachments)};return c})(b.Class);b.Event=a})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(a){var b=(function(c){__extends(d,c);function d(e,g,f){c.call(this);this._event=e;this.handler=g;this.scope=f}d.prototype.destroyObject=function(){this._event.unbind(this);c.prototype.destroyObject.call(this)};return d})(a.Class);a.EventAttachment=b})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(){d.apply(this,arguments);this._ownsItems=false}c.prototype.destroyObject=function(){this.tryClear();d.prototype.destroyObject.call(this)};c.prototype.ownItems=function(){this._ownsItems=true;return this};c.prototype.some=function(f,e){return !this.every(function(g){return f.call(this,g)===false},e)};c.prototype.each=function(f,e){this.every(function(g){f.call(this,g);return true},e)};c.prototype.search=function(g,f){var e;this.every(function(h){if(g.call(this,h)!==false){e=h;return false}return true},f);return e};c.prototype.$toSorted=function(g,f,e){return new b.Array(this.toSorted(g,f,e),true)};c.prototype.$toSortedComparing=function(g,f,e){return new b.Array(this.toSortedComparing(g,f,e),true)};c.prototype.$$toSortedComparing=function(g,f,e){return this.$toSortedComparing(g,f,e)};c.prototype.index=function(g,f){var e={};this.every(function(i){var h=g.call(this,i);if(h!=null){e[h]=i}return true},f);return e};c.prototype.$index=function(f,e){return new b.Map(this.index(f,e),true)};c.prototype.$$index=function(f,e){return this.$index(f,e)};c.prototype.toArray=function(){var e=new _JW.A(this.getLength());
var f=0;this.every(function(g){e[f++]=g;return true});return e};c.prototype.$toArray=function(){return new b.Array(this.toArray(),true)};c.prototype.$$toArray=function(){return this.$toArray()};c.prototype.toSet=function(){var e={};this.every(function(f){b.Set.add(e,f);return true});return e};c.prototype.$toSet=function(){return new b.Set(this.toSet(),true)};c.prototype.$$toSet=function(){return this.$toSet()};c.prototype.asArray=function(){return this.toArray()};c.prototype.$asArray=function(){return new b.Array(this.asArray(),true)};c.prototype.asSet=function(){return this.toSet()};c.prototype.$asSet=function(){return new b.Set(this.asSet(),true)};c.prototype.$count=function(f,e){return new b.Property(this.count(f,e))};c.prototype.$$count=function(f,e){return this.$count(f,e)};return c})(b.Class);b.AbstractCollection=a;var a;(function(g){var j=(function(l){__extends(m,l);function m(o,n){l.call(this);this.source=o;this._filterItem=n.filterItem;this._scope=n.scope||this;this._targetCreated=n.target==null;this.target=this._targetCreated?new b.Property(0):n.target;this.target.set(o.count(this._filterItem,this._scope))}m.prototype.destroyObject=function(){this.target.set(0);if(this._targetCreated){this.target.destroy()}this.source=null;this._filterItem=null;this.target=null;this._scope=null;l.prototype.destroyObject.call(this)};m.prototype.reconfigure=function(n){this._filterItem=n.filterItem||this._filterItem;this._scope=n.scope||this._scope;this.recount()};m.prototype.recount=function(){this.target.set(this.source.count(this._filterItem,this._scope))};return m})(b.Class);g.Counter=j;var k=(function(m){__extends(l,m);function l(o,n){m.call(this);this.source=o;this._filterItem=n.filterItem;this._scope=n.scope||this;this._targetCreated=n.target==null;this.target=this._targetCreated?this.source.createEmpty():n.target}l.prototype.destroyObject=function(){if(this._targetCreated){this.target.destroy()}this.source=null;this._filterItem=null;this.target=null;this._scope=null;m.prototype.destroyObject.call(this)};return l})(b.Class);g.Filterer=k;var c=(function(m){__extends(l,m);function l(o,n){m.call(this);this.source=o;this._getKey=n.getKey;this._scope=n.scope||this;this._targetCreated=n.target==null;this.target=this._targetCreated?o.createEmptyMap():n.target;this.target.trySetAll(this._index(o.asArray()))}l.prototype.destroyObject=function(){this.target.tryRemoveAll(this._keys(this.source.asArray()));if(this._targetCreated){this.target.destroy()}this.source=null;this._getKey=null;this.target=null;this._scope=null;m.prototype.destroyObject.call(this)};l.prototype._index=function(o){var p={};for(var q=0,n=o.length;q<n;++q){var r=o[q];p[this._getKey.call(this._scope,r)]=r}return p};l.prototype._keys=function(o){var q=[];for(var p=0,n=o.length;p<n;++p){q.push(this._getKey.call(this._scope,o[p]))}return q};return l})(b.Class);g.Indexer=c;var e=(function(l){__extends(m,l);function m(o,n){if(n===void 0){n={}}l.call(this);this.source=o;this._targetCreated=n.target==null;this.target=this._targetCreated?o.createEmptySet():n.target;this.target.tryAddAll(o.asArray())}m.prototype.destroyObject=function(){this.target.tryRemoveAll(this.source.asArray());if(this._targetCreated){this.target.destroy()}this.source=null;this.target=null;l.prototype.destroyObject.call(this)};return m})(b.Class);g.Lister=e;var d=(function(l){__extends(m,l);function m(o,n){l.call(this);this.source=o;this._createItem=n.createItem;this._destroyItem=n.destroyItem;this._scope=n.scope||this;this._targetCreated=n.target==null;this.target=this._targetCreated?this.source.createEmpty():n.target}m.prototype.destroyObject=function(){if(this._targetCreated){this.target.destroy()}this.source=null;this._createItem=null;this._destroyItem=null;this.target=null;this._scope=null;l.prototype.destroyObject.call(this)};return m})(b.Class);g.Mapper=d;var f=(function(m){__extends(l,m);function l(o,n){m.call(this);this.source=o;n=n||{};this._addItem=n.addItem;this._removeItem=n.removeItem;this._clearItems=n.clearItems;this._change=n.change;this._scope=n.scope||this;this._addItems(o.asArray())}l.prototype.destroyObject=function(){this._doClearItems(this.source.asArray());this.source=null;this._addItem=null;this._removeItem=null;this._clearItems=null;this._change=null;this._scope=null;m.prototype.destroyObject.call(this)};l.prototype._addItems=function(o){if(!this._addItem){return}for(var p=0,n=o.length;p<n;++p){this._addItem.call(this._scope,o[p])}};l.prototype._removeItems=function(n){if(!this._removeItem){return}for(var o=n.length-1;o>=0;--o){this._removeItem.call(this._scope,n[o])}};l.prototype._doClearItems=function(n){if(n.length===0){return}if(this._clearItems){this._clearItems.call(this._scope,n)}else{this._removeItems(n)}};l.prototype._onChange=function(){this._change.call(this._scope)};return l})(b.Class);g.Observer=f;var h=(function(l){__extends(m,l);function m(o,n){if(n===void 0){n={}}l.call(this);this.source=o;this._targetCreated=n.target==null;this.target=this._targetCreated?o.createEmptyArray():n.target;this.target.tryAddAll(o.asArray())}m.prototype.destroyObject=function(){this.target.removeItems(this.source.asArray());if(this._targetCreated){this.target.destroy()}this.source=null;this.target=null;l.prototype.destroyObject.call(this)};m.prototype._splice=function(p,n){var q=this.target.filter(function(r){return !b.Set.contains(p,r)||b.Set.contains(n,r)});var o=b.Set.$toArray(n).filter(function(r){return !b.Set.contains(p,r)});this.target.trySplice(this.target.detectFilter(q)||[],[new b.AbstractArray.IndexItems(q.length,o)])};return m})(b.Class);g.Orderer=h;var i=(function(m){__extends(l,m);function l(o,n){m.call(this);this.source=o;this._compare=n.compare||b.cmp;this._order=n.order||1;this._scope=n.scope||this;this._targetCreated=n.target==null;this.target=this._targetCreated?o.createEmptyArray():n.target;this._splice([],o.asArray())}l.prototype.destroyObject=function(){this._splice(this.source.asArray(),[]);if(this._targetCreated){this.target.destroy()}this.source=null;this.target=null;this._compare=null;this._scope=null;m.prototype.destroyObject.call(this)};l.prototype.resort=function(){this.target.sortComparing(this._compare,this._scope,this._order)};l.prototype._splice=function(G,p){var o=b.Array.toSortedComparing(G,this._compare,this._scope,this._order);var n=b.Array.toSortedComparing(p,this._compare,this._scope,this._order);G=new _JW.A(G.length);p=new _JW.A(p.length);var D=0;var u=0;var r=0;var w=0;while((D<o.length)||(u<n.length)){var x=o[D];var q=n[u];var E=b.cmp(x===undefined,q===undefined)||(this._order*this._compare.call(this._scope,x,q));if(E<0){G[r++]=x;++D}else{if(E>0){p[w++]=q;++u}else{++D;++u}}}G.splice(r,G.length-r);p.splice(w,p.length-w);var t=0;var C=0;var s=[];var y=[];var B=null;for(var z=0,F=this.target.getLength();z<F;++z){var A=this.target.get(z);if(G[b.Array.binarySearch(G,A,this._compare,this._scope,this._order)-1]===A){if(!B){B=new b.AbstractArray.IndexCount(z,0);s.push(B)}++B.count;--C}else{B=null;var v=new b.AbstractArray.IndexItems(z+C,[]);while((t<p.length)&&(this._order*this._compare.call(this._scope,p[t],A)<0)){v.items.push(p[t++]);++C}if(v.items.length!==0){y.push(v)}}}if(t<p.length){y.push(new b.AbstractArray.IndexItems(z+C,p.slice(t)))}this.target.trySplice(s,y)};return l})(b.Class);g.SorterComparing=i})(a=b.AbstractCollection||(b.AbstractCollection={}))})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(a){var b=(function(d){__extends(c,d);function c(){d.apply(this,arguments)}c.prototype.ownItems=function(){d.prototype.ownItems.call(this);return this};c.prototype.$getKeys=function(){return new a.Array(this.getKeys(),true)};c.prototype.containsKey=function(e){return this.get(e)!==undefined};c.prototype.containsItem=function(e){return !this.every(function(f){return e!==f})};c.prototype.keyOf=function(e){return this.find(function(f){return e===f
})};c.prototype.set=function(g,f){var e=this.trySet(g,f);return(e!==undefined)?e.value:this.get(f)};c.prototype.remove=function(e){return this.tryRemove(e)};c.prototype.removeItem=function(f){var e=this.keyOf(f);if(e!==undefined){this.tryRemove(e)}return e};c.prototype.some=function(f,e){return !this.every(function(h,g){return f.call(this,h,g)===false},e)};c.prototype.each=function(f,e){this.every(function(h,g){f.call(this,h,g);return true},e)};c.prototype.find=function(g,f){var e;this.every(function(i,h){if(g.call(this,i,h)!==false){e=h;return false}return true},f);return e};c.prototype.search=function(g,f){if(f===void 0){f=null}var e;this.every(function(i,h){if(g.call(this,i,h)!==false){e=i;return false}return true},f);return e};c.prototype.$toSorted=function(g,f,e){return new a.Array(this.toSorted(g,f,e),true)};c.prototype.$toSortedComparing=function(g,f,e){return new a.Array(this.toSortedComparing(g,f,e),true)};c.prototype.$getSortingKeys=function(g,f,e){return new a.Array(this.getSortingKeys(g,f,e),true)};c.prototype.$getSortingKeysComparing=function(g,f,e){return new a.Array(this.getSortingKeysComparing(g,f,e),true)};c.prototype.index=function(g,f){var e={};this.every(function(j,i){var h=g.call(this,j,i);if(h!=null){e[h]=j}return true},f);return e};c.prototype.$index=function(f,e){return new a.Map(this.index(f,e),true)};c.prototype.toMap=function(){var e={};this.every(function(g,f){e[_JW.S(f)]=g;return true});return e};c.prototype.$toMap=function(){return new a.Map(this.toMap(),true)};c.prototype.asMap=function(){return this.toMap()};c.prototype.$asMap=function(){return new a.Map(this.asMap(),true)};c.prototype.$count=function(f,e){return new a.Property(this.count(f,e))};c.prototype.$$count=function(f,e){return this.$count(f,e)};return c})(a.AbstractCollection);a.IndexedCollection=b})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(f,e){d.call(this);this.items=e?f:f?f.concat():[]}c.prototype.ownItems=function(){d.prototype.ownItems.call(this);return this};c.prototype.getLength=function(){return this.items.length};c.prototype.isEmpty=function(){return this.items.length===0};c.prototype.getFirst=function(){return this.items[0]};c.prototype.getLast=function(){return this.items[this.items.length-1]};c.prototype.getFirstKey=function(){return(this.items.length!==0)?0:undefined};c.prototype.getLastKey=function(){var e=this.items.length;return(e!==0)?(e-1):undefined};c.prototype.get=function(e){return this.items[e]};c.prototype.getItems=function(){return this.items};c.prototype.getKeys=function(){var g=this.items;var e=new _JW.A(g.length);for(var h=0,f=g.length;h<f;++h){e[h]=h}return e};c.prototype.containsItem=function(e){return b.Array.containsItem(this.items,e)};c.prototype.every=function(f,e){return b.Array.every(this.items,f,e||this)};c.prototype.toSorted=function(g,f,e){return b.Array.toSorted(this.items,g,f||this,e)};c.prototype.toSortedComparing=function(g,f,e){return b.Array.toSortedComparing(this.items,g,f||this,e)};c.prototype.getSortingKeys=function(g,f,e){return b.Array.getSortingKeys(this.items,g,f||this,e)};c.prototype.getSortingKeysComparing=function(g,f,e){return b.Array.getSortingKeysComparing(this.items,g,f||this,e)};c.prototype.filter=function(f,e){return b.Array.filter(this.items,f,e||this)};c.prototype.$filter=function(f,e){return new b.Array(this.filter(f,e||this),true)};c.prototype.$$filter=function(f,e){return this.$filter(f,e||this)};c.prototype.count=function(f,e){return b.Array.count(this.items,f,e||this)};c.prototype.map=function(f,e){return b.Array.map(this.items,f,e||this)};c.prototype.$map=function(f,e){return new b.Array(this.map(f,e||this),true)};c.prototype.$$mapValues=function(f,e){return this.$map(f,e||this)};c.prototype.$$mapObjects=function(f,e){return this.$map(f,e||this).ownItems()};c.prototype.toArray=function(){return this.items.concat()};c.prototype.asArray=function(){return this.items};c.prototype.$asArray=function(){return this};c.prototype.add=function(f,e){this.tryAdd(f,e)};c.prototype.tryAdd=function(f,e){return this.tryAddAll([f],e)};c.prototype.addAll=function(e,f){this.tryAddAll(e,f)};c.prototype.tryAddAll=function(e,f){if(f===undefined){f=this.items.length}if(this.trySplice([],[new c.IndexItems(f,e)])){return true}};c.prototype.trySet=function(g,f){var e=b.Array.trySet(this.items,g,f);if((e!==undefined)&&this._ownsItems){e.value.destroy()}return e};c.prototype.tryRemove=function(f){var e=this.tryRemoveAll(f,1);if(e!==undefined){return e[0]}};c.prototype.removeAll=function(f,g){var e=this.tryRemoveAll(f,g);return e||[]};c.prototype.$removeAll=function(e,f){return new b.Array(this.removeAll(e,f),true)};c.prototype.tryRemoveAll=function(f,g){var e=this.trySplice([new c.IndexCount(f,g)],[]);if(e!==undefined){return e.removedItemsList[0].items}};c.prototype.removeItems=function(e){var g=new b.Set(e);var f=this.filter(function(h){return !g.contains(h)});this.performFilter(f)};c.prototype.move=function(e,f){this.tryMove(e,f);return this.get(f)};c.prototype.tryMove=function(e,f){return b.Array.tryMove(this.items,e,f)};c.prototype.clear=function(){var e=this.tryClear();return(e!==undefined)?e:[]};c.prototype.$clear=function(){return new b.Array(this.clear(),true)};c.prototype.tryClear=function(){var e=b.Array.tryClear(this.items);if((e!==undefined)&&this._ownsItems){b.Array.backEvery(e,b.destroyForcibly)}return e};c.prototype.splice=function(g,f){var e=this.trySplice(g,f);return(e!==undefined)?e:new c.SpliceResult(this.items.concat(),[],[])};c.prototype.trySplice=function(g,e){var f=b.Array.trySplice(this.items,g,e);if((f!==undefined)&&this._ownsItems){b.Array.backEvery(f.getRemovedItems(),b.destroyForcibly)}return f};c.prototype.reorder=function(e){this.tryReorder(e)};c.prototype.tryReorder=function(e){return b.Array.tryReorder(this.items,e)};c.prototype.detectSplice=function(f,e,g){return b.Array.detectSplice(this.items,f,e||this.getKey,g||this)};c.prototype.detectFilter=function(e){return b.Array.detectFilter(this.items,e)};c.prototype.detectReorder=function(f,e,g){return b.Array.detectReorder(this.items,f,e||this.getKey,g||this)};c.prototype.detectSort=function(g,f,e){return b.Array.detectSort(this.items,g,f||this,e)};c.prototype.detectSortComparing=function(g,f,e){return b.Array.detectSortComparing(this.items,g,f||this,e)};c.prototype.performSplice=function(f,e,g){var h=this.detectSplice(f,e||this.getKey,g||this);if(h!==undefined){this.trySplice(h.removeParamsList,h.addParamsList)}};c.prototype.performFilter=function(e){var f=this.detectFilter(e);if(f!==undefined){this.trySplice(f,[])}};c.prototype.performReorder=function(g,f,h){var e=this.detectReorder(g,f||this.getKey,h||this);if(e!==undefined){this.tryReorder(e)}};c.prototype.sort=function(h,g,e){var f=this.detectSort(h,g,e);if(f!==undefined){this.tryReorder(f)}};c.prototype.sortComparing=function(h,g,e){var f=this.detectSortComparing(h,g,e);if(f!==undefined){this.tryReorder(f)}};c.prototype.merge=function(){return b.Array.merge(this.map(function(e){return e.getItems()},this))};c.prototype.$merge=function(){var e=this._createMergerTarget();e.own(this.createMerger({target:e}));return e};c.prototype.$$merge=function(){return this.$merge()};c.prototype.reverse=function(){this.items.reverse()};c.prototype.toReversed=function(){return b.Array.toReversed(this.items)};c.prototype.$toReversed=function(){return new b.Array(this.toReversed(),true)};c.prototype.$$toReversed=function(){return this.$toReversed()};c.prototype.equal=function(e){return b.Array.equal(this.items,e)};c.prototype.collapse=function(e){return b.Array.collapse(this.items,e)};c.prototype.indexOf=function(e){return b.Array.indexOf(this.items,e)};c.prototype.backEvery=function(f,e){return b.Array.backEvery(this.items,f,e)};c.prototype.pop=function(){if(this.items.length!==0){return this.tryRemove(this.items.length-1)
}};c.prototype.binarySearch=function(h,g,f,e){return b.Array.binarySearch(this.items,h,g,f,e)};c.prototype.createMapper=function(e){return new c.Mapper(this,e)};c.prototype.createFilterer=function(e){return new c.Filterer(this,e)};c.prototype.createCounter=function(e){return new c.Counter(this,e)};c.prototype.createObserver=function(e){return new c.Observer(this,e)};c.prototype.createOrderer=function(e){return new c.Orderer(this,e)};c.prototype.createSorterComparing=function(e){return new c.SorterComparing(this,e)};c.prototype.createIndexer=function(e){return new c.Indexer(this,e)};c.prototype.createLister=function(e){return new c.Lister(this,e)};c.prototype.createInserter=function(e){return new c.Inserter(this,e)};c.prototype.createMerger=function(e){return new c.Merger(this,e)};c.prototype.createMergerBunch=function(e){return new b.Class()};c.prototype.createReverser=function(e){return new c.Reverser(this,e)};c.prototype._createMergerTarget=function(){return this.some(function(e){return e instanceof b.ObservableArray})?new b.ObservableArray():new b.Array()};return c})(b.IndexedCollection);b.AbstractArray=a;var a;(function(n){var m=(function(){function r(s,t){this.index=s;this.count=t}r.prototype.clone=function(){return new r(this.index,this.count)};return r})();n.IndexCount=m;var p=(function(){function r(t,s){this.index=t;this.items=s}r.prototype.toIndexCount=function(){return new m(this.index,this.items.length)};r.prototype.clone=function(){return new r(this.index,this.items.concat())};return r})();n.IndexItems=p;var c=(function(){function r(t,u,s){this.oldItems=t;this.removedItemsList=u;this.addedItemsList=s}r.prototype.getRemovedItems=function(){if(!this.removedItems){this.removedItems=b.Array.merge(b.Array.map(this.removedItemsList,function(s){return s.items}))}return this.removedItems};r.prototype.getAddedItems=function(){if(!this.addedItems){this.addedItems=b.Array.merge(b.Array.map(this.addedItemsList,function(s){return s.items}))}return this.addedItems};r.prototype.getRemoveParamsList=function(){if(!this.removeParamsList){this.removeParamsList=b.Array.map(this.removedItemsList,b.byMethod("toIndexCount"))}return this.removeParamsList};r.prototype.isEmpty=function(){return(this.removedItemsList.length===0)&&(this.addedItemsList.length===0)};return r})();n.SpliceResult=c;var o=(function(r){__extends(s,r);function s(u,t){r.call(this,u,t)}return s})(b.AbstractCollection.Counter);n.Counter=o;var q=(function(s){__extends(r,s);function r(u,t){s.call(this,u,t);this._filtered=[];this._splice([],[new n.IndexItems(0,this.source.getItems())])}r.prototype.destroyObject=function(){this.target.tryClear();s.prototype.destroyObject.call(this)};r.prototype._countFiltered=function(u,w){var t=0;for(var v=0;v<w;++v){t+=this._filtered[u+v]}return t};r.prototype._splice=function(z,v){var y=this;var t=0;var u=0;var x=b.Array.map(z,function(B){u+=y._countFiltered(t,B.index-t);var A=y._countFiltered(B.index,B.items.length);var C=new n.IndexCount(u,A);t=B.index+B.items.length;u+=A;return C});b.Array.trySplice(this._filtered,b.Array.map(z,b.byMethod("toIndexCount")),[]);var t=0;var u=0;var w=b.Array.map(v,function(C){u+=y._countFiltered(t,C.index-t);var A=[];var B=b.Array.map(C.items,function(E){if(y._filterItem.call(y._scope,E)===false){return 0}A.push(E);return 1});var D=new n.IndexItems(u,A);b.Array.tryAddAll(y._filtered,B,C.index);t=C.index+B.length;u+=A.length;return D});this.target.trySplice(x,w)};r.prototype.reconfigure=function(t){this._filterItem=b.def(t.filterItem,this._filterItem);this._scope=b.def(t.scope,this._scope);this.refilter()};r.prototype.refilterAt=function(t){var w=this.source.get(t);var v=this._filterItem.call(this._scope,w)!==false;var u=this._countFiltered(0,t);if(this._filtered[t]===0){if(v){this._filtered[t]=1;this.target.add(w,u)}}else{if(!v){this._filtered[t]=0;this.target.remove(u)}}};r.prototype.refilterItem=function(u){var t=this.source.indexOf(u);if(t!==-1){this.refilterAt(t)}};r.prototype.refilter=function(){var w=this;var y=this.source.map(function(C){return(w._filterItem.call(w._scope,C)!==false)?1:0});var v=null;var B=[];function x(){if(v!==null){B.push(v);v=null}}var u=0;this.source.every(function(D,C){if(w._filtered[C]===0){return true}if(y[C]===0){if(v===null){v=new n.IndexCount(u,0)}++v.count;w._filtered[C]=0}else{x()}++u;return true});x();var z=null;var A=[];function t(){if(z!==null){A.push(z);z=null}}var u=0;this.source.every(function(D,C){if(w._filtered[C]===1){t();++u;return true}if(y[C]===1){if(z===null){z=new n.IndexItems(u,[])}z.items.push(D);w._filtered[C]=1;++u}else{t()}return true});t();this._filtered=y;this.target.trySplice(B,A)};return r})(b.AbstractCollection.Filterer);n.Filterer=q;var d=(function(s){__extends(r,s);function r(u,t){s.call(this,u,t)}return r})(b.AbstractCollection.Indexer);n.Indexer=d;var i=(function(s){__extends(r,s);function r(u,t){if(t===void 0){t={}}s.call(this);this.source=u;this._addItem=t.addItem;this._removeItem=t.removeItem;this._clearItems=t.clearItems;this._scope=t.scope||this;this._addItems(this.source.getItems(),0)}r.prototype.destroyObject=function(){this._doClearItems(this.source.getItems());this.source=null;this._addItem=null;this._removeItem=null;this._clearItems=null;this._scope=null;s.prototype.destroyObject.call(this)};r.prototype._addItems=function(t,u){if(!this._addItem){return}for(var v=0;v<t.length;++v){this._addItem.call(this._scope,t[v],v+u)}};r.prototype._removeItems=function(t,u){if(!this._removeItem){return}for(var v=t.length-1;v>=0;--v){this._removeItem.call(this._scope,t[v],v+u)}};r.prototype._doClearItems=function(t){if(t.length===0){return}if(this._clearItems){this._clearItems.call(this._scope,t)}else{this._removeItems(t,0)}};return r})(b.Class);n.Inserter=i;var g=(function(r){__extends(s,r);function s(u,t){r.call(this,u,t)}return s})(b.AbstractCollection.Lister);n.Lister=g;var e=(function(r){__extends(s,r);function s(u,t){r.call(this,u,t);this.target.tryAddAll(this._createItems(this.source.getItems()))}s.prototype.destroyObject=function(){this._destroyItems(this.target.clear(),this.source.getItems());r.prototype.destroyObject.call(this)};s.prototype._createItems=function(t){var v=[];for(var w=0,u=t.length;w<u;++w){v.push(this._createItem.call(this._scope,t[w]))}return v};s.prototype._destroyItems=function(u,t){if(this._destroyItem===undefined){return}for(var v=u.length-1;v>=0;--v){this._destroyItem.call(this._scope,u[v],t[v])}};return s})(b.AbstractCollection.Mapper);n.Mapper=e;var h=(function(r){__extends(s,r);function s(u,t){var v=this;if(t===void 0){t={}}r.call(this);this.source=u;this._targetCreated=t.target==null;this.target=this._targetCreated?u._createMergerTarget():t.target;this._bunches=u.$$mapObjects(function(w){return w.createMergerBunch(v)});this.target.tryAddAll(this._getAllItems())}s.prototype.destroyObject=function(){this.target.tryClear();this._bunches.destroy();if(this._targetCreated){this.target.destroy()}this.source=null;this.target=null;this._bunches=null;r.prototype.destroyObject.call(this)};s.prototype._getAllItems=function(){return this._merge(this.source.getItems())};s.prototype._merge=function(A){var w=new _JW.A(this._count(A));var z=0;for(var y=0,v=A.length;y<v;++y){var u=A[y].getItems();for(var x=0,t=u.length;x<t;++x){w[z++]=u[x]}}return w};s.prototype._count=function(x,t,w){if(t===undefined){t=0}if(w===undefined){w=x.length-t}var v=0;for(var u=0;u<w;++u){v+=x[t+u].getLength()}return v};return s})(b.Class);n.Merger=h;var f=(function(s){__extends(r,s);function r(u,t){s.call(this,u,t)}return r})(b.AbstractCollection.Observer);n.Observer=f;var k=(function(r){__extends(s,r);function s(u,t){r.call(this,u,t)}return s})(b.AbstractCollection.Orderer);n.Orderer=k;var j=(function(r){__extends(s,r);function s(u,t){if(t===void 0){t={}}r.call(this);this.source=u;this._targetCreated=t.target==null;this.target=this._targetCreated?u.createEmpty():t.target;this.target.tryAddAll(this._reverse(u.getItems()))}s.prototype.destroyObject=function(){this.target.tryClear();
if(this._targetCreated){this.target.destroy()}this.source=null;this.target=null;r.prototype.destroyObject.call(this)};s.prototype._reverse=function(t){t=t.concat();t.reverse();return t};return s})(b.Class);n.Reverser=j;var l=(function(s){__extends(r,s);function r(u,t){s.call(this,u,t)}return r})(b.AbstractCollection.SorterComparing);n.SorterComparing=l})(a=b.AbstractArray||(b.AbstractArray={}))})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(f,e){d.call(this);this._adapter=Boolean(e);this.json=e?f:f?b.apply({},f):{};this._length=b.Map.getLength(this.json)}c.prototype.ownItems=function(){d.prototype.ownItems.call(this);return this};c.prototype.getLength=function(){return this._length};c.prototype.isEmpty=function(){return this._length===0};c.prototype.getFirst=function(){return b.Map.getFirst(this.json)};c.prototype.getFirstKey=function(){return b.Map.getFirstKey(this.json)};c.prototype.get=function(e){return this.json[e]};c.prototype.getJson=function(){return this.json};c.prototype.getKeys=function(){return b.Map.getKeys(this.json)};c.prototype.containsItem=function(e){return b.Map.containsItem(this.json,e)};c.prototype.every=function(f,e){return b.Map.every(this.json,f,e||this)};c.prototype.toSorted=function(g,f,e){return b.Map.toSorted(this.json,g,f||this,e)};c.prototype.toSortedComparing=function(g,f,e){return b.Map.toSortedComparing(this.json,g,f||this,e)};c.prototype.getSortingKeys=function(g,f,e){return b.Map.getSortingKeys(this.json,g,f||this,e)};c.prototype.getSortingKeysComparing=function(g,f,e){return b.Map.getSortingKeysComparing(this.json,g,f||this,e)};c.prototype.filter=function(f,e){return b.Map.filter(this.json,f,e||this)};c.prototype.$filter=function(f,e){return new b.Map(this.filter(f,e||this),true)};c.prototype.$$filter=function(f,e){return this.$filter(f,e||this)};c.prototype.count=function(f,e){return b.Map.count(this.json,f,e||this)};c.prototype.map=function(f,e){return b.Map.map(this.json,f,e||this)};c.prototype.$map=function(f,e){return new b.Map(this.map(f,e||this),true)};c.prototype.$$mapValues=function(f,e){return this.$map(f,e||this)};c.prototype.$$mapObjects=function(f,e){return this.$map(f,e||this)};c.prototype.toMap=function(){return b.apply({},this.json)};c.prototype.asMap=function(){return this.json};c.prototype.$asMap=function(){return this};c.prototype.trySet=function(g,f){var e=this._trySet(g,f);if(e===undefined){return undefined}var h=e.value;if(h!==undefined&&this._ownsItems){h.destroy()}return e};c.prototype._trySet=function(g,f){var e=b.Map.trySet(this.json,g,f);if(e===undefined){return}if(e.value===undefined){++this._length}return e};c.prototype.setAll=function(e){for(var f in e){this.trySet(e[f],f)}};c.prototype.setAllVerbose=function(e){var f=this.trySetAll(e);return(f!==undefined)?f:{removedItems:{},addedItems:{}}};c.prototype.trySetAll=function(e){return this.trySplice([],e)};c.prototype.setKey=function(e,f){this.trySetKey(e,f);return this.json[f]};c.prototype.trySetKey=function(e,f){return b.Map.trySetKey(this.json,e,f)};c.prototype.tryRemove=function(e){var f=this._tryRemove(e);if(f!==undefined&&this._ownsItems){f.destroy()}return f};c.prototype._tryRemove=function(e){var f=b.Map.tryRemove(this.json,e);if(f===undefined){return}--this._length;return f};c.prototype.removeAll=function(g){for(var f=0,e=g.length;f<e;++f){this.tryRemove(g[f])}};c.prototype.removeAllVerbose=function(f){var e=this.tryRemoveAll(f);return(e!==undefined)?e:{}};c.prototype.$removeAllVerbose=function(e){return new b.Map(this.removeAllVerbose(e),true)};c.prototype.tryRemoveAll=function(e){var f=this.trySplice(e,{});if(f!==undefined){return f.removedItems}};c.prototype.removeItems=function(e){var g=new b.Set(e);var f=this.filter(function(h){return !g.contains(h)});this.performSplice(f)};c.prototype.clear=function(){var e=this.tryClear();return(e!==undefined)?e:{}};c.prototype.$clear=function(){return new b.Map(this.clear(),true)};c.prototype.tryClear=function(){var e=this._tryClear();if(e!==undefined&&this._ownsItems){b.Array.backEvery(b.Map.toArray(e),b.destroyForcibly)}return e};c.prototype._tryClear=function(){if(this._length===0){return}var e;this._length=0;if(this._adapter){e=b.Map.tryClear(this.json)}else{e=this.json;this.json={}}return e};c.prototype.splice=function(e,f){var g=this.trySplice(e,f);return(g!==undefined)?g:{removedItems:{},addedItems:{}}};c.prototype.trySplice=function(e,f){var g=this._trySplice(e,f);if((g!==undefined)&&this._ownsItems){b.Array.backEvery(b.Map.toArray(g.removedItems),b.destroyForcibly)}return g};c.prototype._trySplice=function(e,f){var g=b.Map.trySplice(this.json,e,f);if(g!==undefined){this._length+=b.Map.getLength(g.addedItems)-b.Map.getLength(g.removedItems);return g}};c.prototype.reindex=function(f){var e=this.tryReindex(f);return(e!==undefined)?e:{}};c.prototype.tryReindex=function(e){return b.Map.tryReindex(this.json,e)};c.prototype.detectSplice=function(e){return b.Map.detectSplice(this.json,e)};c.prototype.detectReindex=function(f,e,g){return b.Map.detectReindex(this.json,f,e||this.getKey,g||this)};c.prototype.performSplice=function(e){var f=this.detectSplice(e);if(f!==undefined){this.trySplice(f.removedKeys,f.updatedItems)}};c.prototype.performReindex=function(f,e,g){var h=this.detectReindex(f,e,g);if(h!==undefined){this.tryReindex(h)}};c.prototype.getInverted=function(){return b.Map.getInverted(this.json)};c.prototype.equal=function(e){return b.Map.equal(this.json,e)};c.prototype.createMapper=function(e){return new c.Mapper(this,e)};c.prototype.createFilterer=function(e){return new c.Filterer(this,e)};c.prototype.createCounter=function(e){return new c.Counter(this,e)};c.prototype.createObserver=function(e){return new c.Observer(this,e)};c.prototype.createOrderer=function(e){return new c.Orderer(this,e)};c.prototype.createSorterComparing=function(e){return new c.SorterComparing(this,e)};c.prototype.createIndexer=function(e){return new c.Indexer(this,e)};c.prototype.createLister=function(e){return new c.Lister(this,e)};c.prototype.createInserter=function(e){return new c.Inserter(this,e)};return c})(b.IndexedCollection);b.AbstractMap=a;var a;(function(c){var k=(function(m){__extends(n,m);function n(p,o){m.call(this,p,o)}return n})(b.AbstractCollection.Counter);c.Counter=k;var l=(function(n){__extends(m,n);function m(p,o){n.call(this,p,o);this.target.trySetAll(p.filter(this._filterItem,this._scope))}m.prototype.destroyObject=function(){this.target.tryRemoveAll(this.source.getKeys());n.prototype.destroyObject.call(this)};return m})(b.AbstractCollection.Filterer);c.Filterer=l;var d=(function(n){__extends(m,n);function m(p,o){n.call(this,p,o)}return m})(b.AbstractCollection.Indexer);c.Indexer=d;var h=(function(n){__extends(m,n);function m(p,o){if(o===void 0){o={}}n.call(this);this.source=p;this._addItem=o.addItem;this._removeItem=o.removeItem;this._scope=o.scope||this;this._clearItems=o.clearItems;this._addItems(this.source.getJson())}m.prototype.destroyObject=function(){this._doClearItems(this.source.getJson());this.source=null;this._addItem=null;this._removeItem=null;this._clearItems=null;this._scope=null;n.prototype.destroyObject.call(this)};m.prototype._addItems=function(o){if(!this._addItem){return}for(var p in o){this._addItem.call(this._scope,o[p],p)}};m.prototype._removeItems=function(o){if(!this._removeItem){return}for(var p in o){this._removeItem.call(this._scope,p,o[p])}};m.prototype._doClearItems=function(o){if(b.Map.isEmpty(o)){return}if(this._clearItems){this._clearItems.call(this._scope||this,o)}else{this._removeItems(o)}};return m})(b.Class);c.Inserter=h;var f=(function(m){__extends(n,m);function n(p,o){m.call(this,p,o)}return n})(b.AbstractCollection.Lister);c.Lister=f;var e=(function(m){__extends(n,m);function n(p,o){m.call(this,p,o);this.target.trySetAll(this._createItems(p.getJson()))
}n.prototype.destroyObject=function(){this._destroyItems(this.target.removeAllVerbose(this.source.getKeys()),this.source.getJson());m.prototype.destroyObject.call(this)};n.prototype._createItems=function(o){var p={};for(var q in o){p[q]=this._createItem.call(this._scope,o[q])}return p};n.prototype._destroyItems=function(p,o){if(this._destroyItem===undefined){return}for(var q in p){this._destroyItem.call(this._scope,p[q],o[q])}};return n})(b.AbstractCollection.Mapper);c.Mapper=e;var g=(function(n){__extends(m,n);function m(p,o){n.call(this,p,o)}return m})(b.AbstractCollection.Observer);c.Observer=g;var i=(function(m){__extends(n,m);function n(p,o){m.call(this,p,o)}return n})(b.AbstractCollection.Orderer);c.Orderer=i;var j=(function(n){__extends(m,n);function m(p,o){n.call(this,p,o)}return m})(b.AbstractCollection.SorterComparing);c.SorterComparing=j})(a=b.AbstractMap||(b.AbstractMap={}))})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(f,e){d.call(this);this._adapter=Boolean(e);this.json=this._adapter?f:f?b.Array.index(f,b.byField("_iid")):{};this._length=b.Set.getLength(this.json)}c.prototype.ownItems=function(){d.prototype.ownItems.call(this);return this};c.prototype.getJson=function(){return this.json};c.prototype.getLength=function(){return this._length};c.prototype.isEmpty=function(){return this._length===0};c.prototype.getFirst=function(){return b.Set.getFirst(this.json)};c.prototype.containsItem=function(e){return this.json.hasOwnProperty(_JW.S(e._iid))};c.prototype.contains=function(e){return this.json.hasOwnProperty(_JW.S(e._iid))};c.prototype.every=function(f,e){return b.Set.every(this.json,f,e)};c.prototype.toSorted=function(g,f,e){return b.Set.toSorted(this.json,g,f||this,e)};c.prototype.toSortedComparing=function(g,f,e){return b.Set.toSortedComparing(this.json,g,f||this,e)};c.prototype.filter=function(f,e){return b.Set.filter(this.json,f,e)};c.prototype.$filter=function(f,e){return b.Set.$filter(this.json,f,e)};c.prototype.$$filter=function(f,e){return this.$filter(f,e)};c.prototype.count=function(f,e){return b.Set.count(this.json,f,e)};c.prototype.map=function(f,e){return b.Set.map(this.json,f,e)};c.prototype.$map=function(f,e){return b.Set.$map(this.json,f,e)};c.prototype.$$mapValues=function(f,e){return this.$map(f,e)};c.prototype.$$mapObjects=function(f,e){return this.$map(f,e)};c.prototype.toSet=function(){return b.apply({},this.json)};c.prototype.$toSet=function(){return new b.Set(this.toSet(),true)};c.prototype.asSet=function(){return this.json};c.prototype.$asSet=function(){return this};c.prototype.add=function(e){return this.tryAdd(e)!==undefined};c.prototype.tryAdd=function(e){if(this.trySplice([],[e])!==undefined){return true}};c.prototype.addAll=function(f){var e=this.tryAddAll(f);return(e!==undefined)?e:[]};c.prototype.$addAll=function(e){return new b.Array(this.addAll(e),true)};c.prototype.tryAddAll=function(e){var f=this.trySplice([],e);if(f!==undefined){return f.addedItems}};c.prototype.remove=function(e){return this.tryRemove(e)!==undefined};c.prototype.tryRemove=function(e){if(this.trySplice([e],[])!==undefined){return true}};c.prototype.removeItem=function(e){this.tryRemove(e)};c.prototype.removeAll=function(f){var e=this.tryRemoveAll(f);return(e!==undefined)?e:[]};c.prototype.$removeAll=function(e){return new b.Array(this.removeAll(e),true)};c.prototype.tryRemoveAll=function(e){var f=this.trySplice(e,[]);if(f!==undefined){return f.removedItems}};c.prototype.removeItems=function(e){this.tryRemoveAll(e)};c.prototype.clear=function(){var e=this.tryClear();return(e!==undefined)?e:[]};c.prototype.$clear=function(){return new b.Array(this.clear(),true)};c.prototype.tryClear=function(){var e=this._tryClear();if(e!==undefined&&this._ownsItems){b.Array.backEvery(e,b.destroyForcibly)}return e};c.prototype._tryClear=function(){if(this._length===0){return}var e;this._length=0;if(this._adapter){e=b.Set.tryClear(this.json)}else{e=this.toArray();this.json={}}return e};c.prototype.splice=function(e,f){var g=this.trySplice(e,f);return(g!==undefined)?g:{addedItems:[],removedItems:[]}};c.prototype.trySplice=function(e,f){var g=this._trySplice(e,f);if((g!==undefined)&&this._ownsItems){b.Array.backEvery(g.removedItems,b.destroyForcibly)}return g};c.prototype._trySplice=function(e,f){var g=b.Set.trySplice(this.json,e,f);if(g!==undefined){this._length+=g.addedItems.length-g.removedItems.length;return g}};c.prototype.detectSplice=function(e){return b.Set.detectSplice(this.json,e)};c.prototype.performSplice=function(e){var f=this.detectSplice(e);if(f!==undefined){this.trySplice(f.removedItems,f.addedItems)}};c.prototype.equal=function(e){return b.Set.equal(this.json,e)};c.prototype.createMapper=function(e){return new c.Mapper(this,e)};c.prototype.createFilterer=function(e){return new c.Filterer(this,e)};c.prototype.createCounter=function(e){return new c.Counter(this,e)};c.prototype.createObserver=function(e){return new c.Observer(this,e)};c.prototype.createOrderer=function(e){return new c.Orderer(this,e)};c.prototype.createSorterComparing=function(e){return new c.SorterComparing(this,e)};c.prototype.createIndexer=function(e){return new c.Indexer(this,e)};c.prototype.createLister=function(e){return new c.Lister(this,e)};return c})(b.AbstractCollection);b.AbstractSet=a;var a;(function(k){var i=(function(l){__extends(m,l);function m(o,n){l.call(this,o,n)}return m})(b.AbstractCollection.Counter);k.Counter=i;var j=(function(m){__extends(l,m);function l(o,n){m.call(this,o,n);this.target.tryAddAll(o.$toArray().filter(this._filterItem,this._scope))}l.prototype.destroyObject=function(){this.target.tryRemoveAll(this.source.toArray());m.prototype.destroyObject.call(this)};return l})(b.AbstractCollection.Filterer);k.Filterer=j;var c=(function(m){__extends(l,m);function l(o,n){m.call(this,o,n)}return l})(b.AbstractCollection.Indexer);k.Indexer=c;var e=(function(l){__extends(m,l);function m(o,n){l.call(this,o,n)}return m})(b.AbstractCollection.Lister);k.Lister=e;var d=(function(l){__extends(m,l);function m(o,n){l.call(this,o,n);this._items={};this.target.tryAddAll(this._createItems(o.toArray()))}m.prototype.destroyObject=function(){var n=this.source.toArray();this.target.tryRemoveAll(this._getItems(n));this._destroyItems(n);l.prototype.destroyObject.call(this)};m.prototype._getItems=function(n){var o=this;return b.Array.map(n,function(p){return o._items[p._iid]},this)};m.prototype._createItems=function(n){var p=[];for(var q=0,o=n.length;q<o;++q){var s=n[q];var r=this._createItem.call(this._scope||this,s);p.push(r);this._items[s._iid]=r}return p};m.prototype._destroyItems=function(n){if(this._destroyItem===undefined){return}for(var o=n.length-1;o>=0;--o){var q=n[o];var r=q._iid;var p=this._items[r];delete this._items[r];this._destroyItem.call(this._scope||this,p,q)}};return m})(b.AbstractCollection.Mapper);k.Mapper=d;var f=(function(m){__extends(l,m);function l(o,n){m.call(this,o,n)}return l})(b.AbstractCollection.Observer);k.Observer=f;var g=(function(l){__extends(m,l);function m(o,n){l.call(this,o,n)}return m})(b.AbstractCollection.Orderer);k.Orderer=g;var h=(function(m){__extends(l,m);function l(o,n){m.call(this,o,n)}return l})(b.AbstractCollection.SorterComparing);k.SorterComparing=h})(a=b.AbstractSet||(b.AbstractSet={}))})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(f,e){d.call(this,f,e)}c.prototype.ownItems=function(){d.prototype.ownItems.call(this);return this};c.prototype.createEmpty=function(){return new c()};c.prototype.createEmptyArray=function(){return new c()};c.prototype.createEmptyMap=function(){return new b.Map()
};c.prototype.createEmptySet=function(){return new b.Set()};c.getFirst=function(e){return e[0]};c.getFirstKey=function(e){if(e.length!==0){return 0}};c.getLast=function(e){return e[e.length-1]};c.getLastKey=function(e){var f=e.length;if(f!==0){return f-1}};c.getLength=function(e){return e.length};c.isEmpty=function(e){return e.length===0};c.get=function(e,f){return e[f]};c.getKeys=function(f){var e=new _JW.A(f.length);for(var h=0,g=f.length;h<g;++h){e[h]=h}return e};c.$getKeys=function(e){return new c(c.getKeys(e),true)};c.containsKey=function(e,f){return e[f]!==undefined};c.containsItem=function(e,f){return !c.every(e,function(g){return f!==g})};c.keyOf=function(e,f){return c.find(e,function(g){return f===g})};c.every=function(e,j,h){for(var g=0,f=e.length;g<f;++g){if(j.call(h||e,e[g],g)===false){return false}}return true};c.some=function(e,g,f){return !c.every(e,function(i,h){return g.call(this,i,h)===false},f)};c.each=function(e,g,f){c.every(e,function(i,h){g.call(this,i,h);return true},f)};c.find=function(f,h,g){var e;c.every(f,function(j,i){if(h.call(this,j,i)!==false){e=i;return false}return true},g);return e};c.search=function(f,h,g){var e;c.every(f,function(j,i){if(h.call(this,j,i)!==false){e=j;return false}return true},g);return e};c.filter=function(f,h,g){var e=[];c.every(f,function(j,i){if(h.call(this,j,i)!==false){e.push(j)}return true},g);return e};c.$filter=function(e,g,f){return new c(c.filter(e,g,f),true)};c.count=function(f,h,g){var e=0;c.every(f,function(j,i){if(h.call(this,j,i)!==false){++e}return true},g);return e};c.$count=function(e,g,f){return new b.Property(c.count(e,g,f))};c.map=function(f,h,g){var e=new _JW.A(f.length);c.every(f,function(j,i){e[i]=h.call(this,j,i);return true},g);return e};c.$map=function(e,g,f){return new c(c.map(e,g,f),true)};c.getSortingKeys=function(f,i,g,e){i=i||function(j){return j};e=e||1;var h=[];c.every(f,function(k,j){h.push([j,i.call(this,k,j)]);return true},g);h.sort(function(j,k){return e*b.cmp(j[1],k[1])});return c.map(h,function(j){return j[0]})};c.$getSortingKeys=function(f,h,g,e){return new c(c.getSortingKeys(f,h,g,e),true)};c.getSortingKeysComparing=function(f,i,g,e){i=i||b.cmpCaseSensitive;e=e||1;var h=[];c.every(f,function(k,j){h.push([j,k]);return true},g);h.sort(function(j,k){return e*i.call(g,j[1],k[1],j[0],k[0])});return c.map(h,function(j){return j[0]})};c.$getSortingKeysComparing=function(f,h,g,e){return new c(c.getSortingKeysComparing(f,h,g,e),true)};c.toSorted=function(f,h,g,e){return c.map(c.getSortingKeys(f,h,g,e),function(i){return f[i]})};c.$toSorted=function(f,h,g,e){return new c(c.toSorted(f,h,g,e),true)};c.toSortedComparing=function(f,h,g,e){return c.map(c.getSortingKeysComparing(f,h,g,e),function(i){return f[i]})};c.$toSortedComparing=function(f,h,g,e){return new c(c.toSortedComparing(f,h,g,e),true)};c.index=function(f,h,g){var e={};c.every(f,function(k,i){var j=h.call(this,k,i);if(j!=null){e[j]=k}return true},g);return e};c.$index=function(e,g,f){return new b.Map(c.index(e,g,f),true)};c.toArray=function(e){return e.concat()};c.$toArray=function(e){return new c(e)};c.toMap=function(f){var e={};c.every(f,function(h,g){e[g]=h;return true});return e};c.$toMap=function(e){return new b.Map(c.toMap(e),true)};c.toSet=function(e){return c.index(e,b.iidForcibly)};c.$toSet=function(e){return new b.Set(e)};c.asArray=function(e){return e};c.$asArray=function(e){return new c(e,true)};c.asMap=function(e){return c.toMap(e)};c.$asMap=function(e){return c.$toMap(e)};c.asSet=function(e){return c.toSet(e)};c.$asSet=function(e){return c.$toSet(e)};c.add=function(e,g,f){c.tryAdd(e,g,f)};c.tryAdd=function(e,g,f){e.splice(b.def(f,e.length),0,g);return true};c.addAll=function(e,f,g){c.tryAddAll(e,f,g)};c.tryAddAll=function(e,g,j){if(g.length===0){return}if(j===undefined){var f=e.length;e.length+=g.length;for(var k=0;k<g.length;++k){e[k+f]=g[k]}}else{var h=e.splice(j,e.length-j);c.tryAddAll(e,g);c.tryAddAll(e,h)}return true};c.set=function(f,h,g){var e=c.trySet(f,h,g);return(e!==undefined)?e.value:f[g]};c.trySet=function(e,g,f){var h=e[f];if(g!==h){e[f]=g;return{value:h}}};c.remove=function(e,f){return c.tryRemove(e,f)};c.tryRemove=function(e,f){return e.splice(f,1)[0]};c.removeAll=function(f,g,h){var e=c.tryRemoveAll(f,g,h);return e||[]};c.$removeAll=function(e,f,g){return new c(c.removeAll(e,f,g),true)};c.tryRemoveAll=function(e,f,g){if(g!==0){return e.splice(f,g)}};c.removeItem=function(e,g){var f=c.keyOf(e,g);if(f!==undefined){c.tryRemove(e,f)}return f};c.removeItems=function(e,f){var h=new b.Set(f);var g=c.filter(e,function(i){return !h.contains(i)});c.performSplice(e,g)};c.move=function(e,f,g){c.tryMove(e,f,g);return e[g]};c.tryMove=function(e,f,h){if(f===h){return}var g=e[f];e.splice(f,1);e.splice(h,0,g);return g};c.clear=function(f){var e=c.tryClear(f);return(e!==undefined)?e:[]};c.$clear=function(e){return new c(c.clear(e),true)};c.tryClear=function(e){if(e.length!==0){return e.splice(0,e.length)}};c.splice=function(f,h,g){var e=c.trySplice(f,h,g);return(e!==undefined)?e:new b.AbstractArray.SpliceResult(f.concat(),[],[])};c.trySplice=function(m,u,r){var e=[];var v=null;var f;for(var k=0,h=u.length;k<h;++k){f=u[k];if(v&&(f.index===v.index+v.count)){v.count+=f.count}else{v=f.clone();e.push(v)}}var q=[];var j=null;var t;for(var k=0,h=r.length;k<h;++k){t=r[k];if(j&&(t.index===j.index+j.items.length)){c.tryAddAll(j.items,t.items)}else{j=t.clone();q.push(j)}}var s=m.concat();var p=[];for(var k=e.length-1;k>=0;--k){f=e[k];var n=f.index;var o=c.tryRemoveAll(m,n,f.count);if(o===undefined){continue}p.push(new b.AbstractArray.IndexItems(n,o))}var g=[];for(var k=0,h=q.length;k<h;++k){t=q[k];if(c.tryAddAll(m,t.items,t.index)===undefined){continue}g.push(t)}if((p.length!==0)||(g.length!==0)){p.reverse();return new b.AbstractArray.SpliceResult(s,p,g)}};c.reorder=function(e,f){c.tryReorder(e,f)};c.tryReorder=function(e,f){var h=e.length;if(c.isIdentity(f)){return}var j=e.concat();for(var g=0;g<h;++g){e[f[g]]=j[g]}return j};c.detectSplice=function(o,k,n,e){n=n||b.iidForcibly;e=e||o;var j=[];var q=[];var p={};for(var u=0,s=o.length;u<s;++u){p[n.call(e,o[u])]=u}var y=0;var h=0;var v=[];function t(i){v.push(i)}function r(){if(v.length===0){return}q.push(new b.AbstractArray.IndexItems(h+y,v));h+=v.length;v=[]}function m(l){if(l>y){var i=l-y;j.push(new b.AbstractArray.IndexCount(y,i));h-=i}}for(var f=0,s=k.length;f<s;++f){var w=k[f];var x=n.call(e,w);var g=p[x];if((g===undefined)||(g<y)){t(w)}else{r();m(g);y=g+1}}r();m(o.length);if((j.length!==0)||(q.length!==0)){return{removeParamsList:j,addParamsList:q}}};c.detectFilter=function(j,m){var l=[];var i=0;var e=j.length;var f=m.length;for(var k=0;k<=f;++k){var g=m[k];var h=0;while((i+h<e)&&(j[i+h]!==g)){++h}if(h!==0){l.push(new b.AbstractArray.IndexCount(i,h))}i+=h+1}if(l.length!==0){return l}};c.detectReorder=function(m,h,g,k){g=g||b.iidForcibly;k=k||m;var f=[];var n={};for(var j=0,e=h.length;j<e;++j){n[g.call(k,h[j])]=j}for(var j=0,e=m.length;j<e;++j){f.push(n[g.call(k,m[j])])}if(!c.isIdentity(f)){return f}};c.detectSort=function(f,i,g,e){var h=c.getSortingKeys(f,i,g,e);if(!c.isIdentity(h)){return c.invert(h)}};c.detectSortComparing=function(f,i,g,e){var h=c.getSortingKeysComparing(f,i,g,e);if(!c.isIdentity(h)){return c.invert(h)}};c.performSplice=function(e,g,f,h){var i=c.detectSplice(e,g,f,h);if(i!==undefined){c.trySplice(e,i.removeParamsList,i.addParamsList)}};c.performFilter=function(e,f){var g=c.detectFilter(e,f);if(g!==undefined){c.trySplice(e,g,[])}};c.performReorder=function(e,h,g,i){var f=c.detectReorder(e,h,g,i);if(f!==undefined){c.tryReorder(e,f)}};c.sort=function(f,i,h,e){var g=c.detectSort(f,i,h,e);if(g!==undefined){c.tryReorder(f,g)}};c.sortComparing=function(f,i,h,e){var g=c.detectSortComparing(f,i,h,e);if(g!==undefined){c.tryReorder(f,g)}};c.equal=function(e,h){if(e===h){return true}if(e.length!==h.length){return false}for(var g=0,f=e.length;g<f;++g){if(e[g]!==h[g]){return false}}return true};c.collapse=function(f,j){var e=[];for(var h=0,g=f.length;
h<g;++h){if(!b.isArray(f[h])){e.push(f[h]);continue}if(j==null){c.tryAddAll(e,c.collapse(f[h]));continue}if(j){c.tryAddAll(e,c.collapse(f[h],j-1));continue}e.push(f[h])}return e};c.indexOf=function(e,g){if(_JW.A.prototype.indexOf!==undefined){return e.indexOf(g)}var f=c.keyOf(e,g);return(f!==undefined)?f:-1};c.backEvery=function(e,h,g){for(var f=e.length-1;f>=0;--f){if(h.call(g||e,e[f],f)===false){return false}}return true};c.cmp=function(g,k,f){var j=Math.min(g.length,k.length);for(var h=0;h<j;++h){var e=b.cmp(g[h],k[h],f);if(e){return e}}return b.cmp(g.length,k.length)};c.shuffle=function(k){var e=new _JW.A(k);for(var h=0;h<k;++h){e[h]=h}for(var h=0;h<k;++h){var f=h+Math.floor(Math.random()*(k-h));var g=e[h];e[h]=e[f];e[f]=g}return e};c.isIdentity=function(g){for(var f=0,e=g.length;f<e;++f){if(g[f]!==f){return false}}return true};c.invert=function(h){var f=h.length;var e=new _JW.A(f);for(var g=0;g<f;++g){e[h[g]]=g}return e};c.merge=function(h){var e=[];for(var g=0,f=h.length;g<f;++g){e.push.apply(e,h[g])}return e};c.$merge=function(e){return new c(c.merge(e),true)};c.countMerged=function(h){var e=0;for(var g=0,f=h.length;g<f;++g){e+=h[g].length}return e};c.reverse=function(e){e.reverse()};c.toReversed=function(f){var e=f.concat();e.reverse();return e};c.$toReversed=function(e){return new c(c.toReversed(e),true)};c.pop=function(e){return e.pop()};c.binarySearch=function(j,l,e,m,h){e=e||function(n,o){return(n<o)?-1:(n>o)?1:0};m=m||j;h=h||1;var f=j.length;var i=f>>1;var g=1;while(g<=i){g<<=1}var k=0;while(g){if((k+g<=f)&&(h*e.call(m,l,j[k+g-1])>=0)){k+=g}g>>=1}return k};return c})(b.AbstractArray);b.Array=a})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(f,e){d.call(this,f,e)}c.prototype.ownItems=function(){d.prototype.ownItems.call(this);return this};c.prototype.createEmpty=function(){return new c()};c.prototype.createEmptyArray=function(){return new b.Array()};c.prototype.createEmptyMap=function(){return new c()};c.prototype.createEmptySet=function(){return new b.Set()};c.getFirst=function(e){return e[c.getFirstKey(e)]};c.getFirstKey=function(f){for(var e in f){return e}};c.getLength=function(g){var f=0;for(var e in g){++f}return f};c.isEmpty=function(f){for(var e in f){return false}return true};c.get=function(f,e){return f[e]};c.getKeys=function(g){var f=new _JW.A();for(var e in g){f.push(e)}return f};c.$getKeys=function(e){return new b.Array(c.getKeys(e),true)};c.containsKey=function(f,e){return f[e]!==undefined};c.containsItem=function(f,e){return !c.every(f,function(g){return e!==g})};c.keyOf=function(f,e){return c.find(f,function(g){return e===g})};c.every=function(g,h,f){f=f||g;for(var e in g){if(h.call(f,g[e],e)===false){return false}}return true};c.some=function(f,g,e){return !c.every(f,function(i,h){return g.call(this,i,h)===false},e)};c.each=function(f,g,e){c.every(f,function(i,h){g.call(this,i,h);return true},e)};c.find=function(g,h,f){var e;c.every(g,function(j,i){if(h.call(this,j,i)!==false){e=i;return false}return true},f);return e};c.search=function(g,h,f){var e;c.every(g,function(j,i){if(h.call(this,j,i)!==false){e=j;return false}return true},f);return e};c.filter=function(g,h,f){var e={};c.every(g,function(j,i){if(h.call(this,j,i)!==false){e[i]=j}return true},f);return e};c.$filter=function(f,g,e){return new c(c.filter(f,g,e),true)};c.count=function(g,h,f){var e=0;c.every(g,function(j,i){if(h.call(this,j,i)!==false){++e}return true},f);return e};c.$count=function(f,g,e){return new b.Property(c.count(f,g,e))};c.map=function(g,h,f){var e={};c.every(g,function(j,i){e[i]=h.call(this,j,i);return true},f);return e};c.$map=function(f,g,e){return new c(c.map(f,g,e),true)};c.getSortingKeys=function(h,i,f,e){i=i||function(j){return j};e=e||1;var g=[];c.every(h,function(k,j){g.push([j,i.call(this,k,j)]);return true},f);g.sort(function(j,k){return e*b.cmp(j[1],k[1])});return b.Array.map(g,function(j){return j[0]})};c.$getSortingKeys=function(g,h,f,e){return new b.Array(c.getSortingKeys(g,h,f,e),true)};c.getSortingKeysComparing=function(i,h,f,e){h=h||b.cmpCaseSensitive;e=e||1;var g=[];c.every(i,function(k,j){g.push([j,k]);return true},f);g.sort(function(j,k){return e*h.call(f,j[1],k[1],j[0],k[0])});return b.Array.map(g,function(j){return j[0]})};c.$getSortingKeysComparing=function(h,g,f,e){return new b.Array(c.getSortingKeysComparing(h,g,f,e),true)};c.toSorted=function(g,h,f,e){return b.Array.map(c.getSortingKeys(g,h,f,e),function(i){return g[i]})};c.$toSorted=function(g,h,f,e){return new b.Array(c.toSorted(g,h,f,e),true)};c.toSortedComparing=function(h,g,f,e){return b.Array.map(c.getSortingKeysComparing(h,g,f,e),function(i){return h[i]})};c.$toSortedComparing=function(h,g,f,e){return new b.Array(c.toSortedComparing(h,g,f,e),true)};c.index=function(g,h,f){var e={};c.every(g,function(j,k){var i=h.call(this,j,k);if(i!=null){e[i]=j}return true},f);return e};c.$index=function(f,g,e){return new c(c.index(f,g,e),true)};c.toArray=function(f){var e=[];c.every(f,function(g){e.push(g);return true});return e};c.$toArray=function(e){return new b.Array(c.toArray(e))};c.toMap=function(e){return b.apply({},e)};c.$toMap=function(e){return new c(c.toMap(e),true)};c.toSet=function(e){return c.index(e,b.iidForcibly)};c.$toSet=function(e){return new b.Set(c.toSet(e),true)};c.asArray=function(e){return c.toArray(e)};c.$asArray=function(e){return c.$toArray(e)};c.asMap=function(e){return e};c.$asMap=function(e){return new c(e,true)};c.asSet=function(e){return c.toSet(e)};c.$asSet=function(e){return c.$toSet(e)};c.set=function(h,g,f){var e=c.trySet(h,g,f);return(e!==undefined)?e.value:h[f]};c.trySet=function(h,f,e){var g=h[e];if(g===f){return}h[e]=f;return{value:g}};c.setAll=function(g,e){for(var f in e){g[f]=e[f]}};c.setAllVerbose=function(f,e){var g=c.trySetAll(f,e);return(g!==undefined)?g:{removedItems:{},addedItems:{}}};c.trySetAll=function(l,f){var e={};var h={};for(var g in f){var j=f[g];var k=c.trySet(l,j,g);if(k===undefined){continue}var i=k.value;if(i!==undefined){e[g]=i}h[g]=j}if(!c.isEmpty(e)||!c.isEmpty(h)){return{removedItems:e,addedItems:h}}};c.setKey=function(g,f,h){var e=c.trySetKey(g,f,h);return(e!==undefined)?e:g[h]};c.trySetKey=function(g,f,h){if(f===h){return}var e=g[f];delete g[f];g[h]=e;return e};c.removeItem=function(g,f){var e=c.keyOf(g,f);if(e!==undefined){c.tryRemove(g,e)}return e};c.remove=function(f,e){return c.tryRemove(f,e)};c.tryRemove=function(g,e){var f=g[e];if(f!==undefined){delete g[e]}return f};c.removeAll=function(j,h){for(var g=0,e=h.length;g<e;++g){var f=h[g];delete j[f]}};c.removeAllVerbose=function(g,f){var e=c.tryRemoveAll(g,f);return(e!==undefined)?e:{}};c.$removeAllVerbose=function(f,e){return new c(c.removeAllVerbose(f,e))};c.tryRemoveAll=function(m,k){var f={};for(var h=0,e=k.length;h<e;++h){var g=k[h];var j=c.tryRemove(m,g);if(j!==undefined){f[g]=j}}if(!c.isEmpty(f)){return f}};c.removeItems=function(h,e){var g=new b.Set(e);var f=c.filter(h,function(i){return !g.contains(i)});c.performSplice(h,f)};c.clear=function(f){var e=c.tryClear(f);return(e!==undefined)?e:{}};c.$clear=function(e){return new c(c.clear(e),true)};c.tryClear=function(g){if(c.isEmpty(g)){return}var e=b.apply({},g);for(var f in e){delete g[f]}return e};c.splice=function(f,e,g){var h=c.trySplice(f,e,g);return(h!==undefined)?h:{removedItems:{},addedItems:{}}};c.trySplice=function(g,f,h){f=b.Array.filter(f,function(j){return !h.hasOwnProperty(j)});var e=c.tryRemoveAll(g,f);var i=c.trySetAll(g,h);if(i!==undefined){b.apply(i.removedItems,e);return i}if(e!==undefined){return{removedItems:e,addedItems:{}}}};c.reindex=function(f,g){var e=c.tryReindex(f,g);return(e!==undefined)?e:{}};c.tryReindex=function(e,o){var f={};for(var n in o){var p=o[n];if((p===undefined)||(p===n)||(e[n]===undefined)){continue}f[n]=p}var k=c.getInverted(f);
var j=[];var h={};for(var n in f){var p=f[n];f[n]=p;h[p]=e[n];if(k[n]===undefined){j.push(n)}}if(c.isEmpty(f)){return}for(var m=0,g=j.length;m<g;++m){delete e[j[m]]}b.apply(e,h);return f};c.detectSplice=function(j,e){var g=[];var i={};for(var f in j){if(!e.hasOwnProperty(f)){g.push(f)}}for(var f in e){var h=e[f];if(h!==j[f]){i[f]=h}}if((g.length!==0)||!c.isEmpty(i)){return{removedKeys:g,updatedItems:i}}};c.detectReindex=function(i,m,f,l){f=f||b.iidForcibly;l=l||i;var k={};for(var j in m){k[f.call(l,m[j])]=j}var g={};for(var e in i){var h=k[f.call(l,i[e])];if(e!==h){g[e]=h}}if(!c.isEmpty(g)){return g}};c.performSplice=function(f,e){var g=c.detectSplice(f,e);if(g!==undefined){c.trySplice(f,g.removedKeys,g.updatedItems)}};c.performReindex=function(h,f,e,g){var i=c.detectReindex(h,f,e,g);if(i!==undefined){c.tryReindex(h,i)}};c.equal=function(e,h){if(e===h){return true}var g=c.getLength(h);for(var f in e){if((--g<0)||(e[f]!==h[f])){return false}}return g===0};c.single=function(f,g){var e={};e[f]=g;return e};c.getRemovedKeys=function(e,g){var h=[];for(var f in e){if(!g.hasOwnProperty(f)){h.push(f)}}return h};c.getInverted=function(g){var e={};for(var f in g){e[g[f]]=f}return e};return c})(b.AbstractMap);b.Map=a})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(f,e){d.call(this,f,e);this.spliceEvent=new b.Event();this.replaceEvent=new b.Event();this.moveEvent=new b.Event();this.clearEvent=new b.Event();this.reorderEvent=new b.Event();this.changeEvent=new b.Event();this.length=new b.Property(this.getLength())}c.prototype.ownItems=function(){d.prototype.ownItems.call(this);return this};c.prototype.destroyObject=function(){this.changeEvent.destroy();this.reorderEvent.destroy();this.clearEvent.destroy();this.moveEvent.destroy();this.replaceEvent.destroy();this.spliceEvent.destroy();this.length.destroy();d.prototype.destroyObject.call(this)};c.prototype.trySet=function(f,e){var g=b.Array.trySet(this.items,f,e);if(g===undefined){return}this.replaceEvent.trigger({sender:this,index:e,oldItem:g.value,newItem:f});this.changeEvent.trigger({sender:this});if(this._ownsItems){g.value.destroy()}return g};c.prototype.tryMove=function(e,g){var f=d.prototype.tryMove.call(this,e,g);if(f===undefined){return}this.moveEvent.trigger({sender:this,fromIndex:e,toIndex:g,item:f});this.changeEvent.trigger({sender:this});return f};c.prototype.tryClear=function(){var e=b.Array.tryClear(this.items);if(e===undefined){return}this.length.set(0);this.clearEvent.trigger({sender:this,items:e});this.changeEvent.trigger({sender:this});if(this._ownsItems){b.Array.backEvery(e,b.destroyForcibly)}return e};c.prototype.trySplice=function(g,f){var e=b.Array.trySplice(this.items,g,f);if(e===undefined){return}this.length.set(this.getLength());this.spliceEvent.trigger({sender:this,spliceResult:e});this.changeEvent.trigger({sender:this});if(this._ownsItems){b.Array.backEvery(e.getRemovedItems(),b.destroyForcibly)}return e};c.prototype.tryReorder=function(f){var e=d.prototype.tryReorder.call(this,f);if(e===undefined){return}this.reorderEvent.trigger({sender:this,indexArray:f,items:e});this.changeEvent.trigger({sender:this});return e};c.prototype.reverse=function(){var f=this.getLength();var g=new _JW.A(f);for(var e=0;e<f;++e){g[e]=f-e-1}this.reorder(g)};c.prototype.$$toSortedComparing=function(h,g,f){var e=new c();e.own(this.createSorterComparing({target:e,compare:h,scope:g||this,order:f}));return e};c.prototype.$$index=function(g,f){var e=new b.ObservableMap();e.own(this.createIndexer({target:e,getKey:g,scope:f||this}));return e};c.prototype.$$toArray=function(){var e=new c();e.own(this.createOrderer({target:e}));return e};c.prototype.$$toSet=function(){var e=new b.ObservableSet();e.own(this.createLister({target:e}));return e};c.prototype.$$filter=function(g,f){var e=new c();e.own(this.createFilterer({target:e,filterItem:g,scope:f||this}));return e};c.prototype.$$count=function(g,f){var e=new b.Property(0);e.own(this.createCounter({target:e,filterItem:g,scope:f||this}));return e};c.prototype.$$mapValues=function(g,f){var e=new c();e.own(this.createMapper({target:e,createItem:g,scope:f||this}));return e};c.prototype.$$mapObjects=function(g,f){var e=new c();e.own(this.createMapper({target:e,createItem:g,destroyItem:b.destroy,scope:f||this}));return e};c.prototype.$$toReversed=function(){var e=new c();e.own(this.createReverser({target:e}));return e};c.prototype.createEmpty=function(){return new c()};c.prototype.createEmptyArray=function(){return new c()};c.prototype.createEmptyMap=function(){return new b.ObservableMap()};c.prototype.createEmptySet=function(){return new b.ObservableSet()};c.prototype.createMapper=function(e){return new c.Mapper(this,e)};c.prototype.createFilterer=function(e){return new c.Filterer(this,e)};c.prototype.createCounter=function(e){return new c.Counter(this,e)};c.prototype.createObserver=function(e){return new c.Observer(this,e)};c.prototype.createOrderer=function(e){return new c.Orderer(this,e)};c.prototype.createSorterComparing=function(e){return new c.SorterComparing(this,e)};c.prototype.createIndexer=function(e){return new c.Indexer(this,e)};c.prototype.createLister=function(e){return new c.Lister(this,e)};c.prototype.createInserter=function(e){return new c.Inserter(this,e)};c.prototype.createMerger=function(e){return new c.Merger(this,e)};c.prototype.createMergerBunch=function(e){return new c.Merger.Bunch(e,this)};c.prototype.createReverser=function(e){return new c.Reverser(this,e)};c.prototype._createMergerTarget=function(){return new c()};return c})(b.AbstractArray);b.ObservableArray=a;var a;(function(c){var m=(function(o){__extends(p,o);function p(r,q){o.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.clearEvent.bind(this._onClear,this))}p.prototype._onSplice=function(r){var t=this;var s=r.spliceResult;var q=this.target.get();b.Array.every(s.removedItemsList,function(u){q-=b.Array.count(u.items,t._filterItem,t._scope);return true});b.Array.every(s.addedItemsList,function(u){q+=b.Array.count(u.items,t._filterItem,t._scope);return true});this.target.set(q)};p.prototype._onReplace=function(s){var q=this._filterItem.call(this._scope,s.oldItem)!==false;var r=this._filterItem.call(this._scope,s.newItem)!==false;if(q&&!r){this.target.set(this.target.get()-1)}else{if(!q&&r){this.target.set(this.target.get()+1)}}};p.prototype._onClear=function(q){this.target.set(0)};return p})(b.AbstractArray.Counter);c.Counter=m;var n=(function(p){__extends(o,p);function o(r,q){p.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.moveEvent.bind(this._onMove,this));this.own(r.clearEvent.bind(this._onClear,this));this.own(r.reorderEvent.bind(this._onReorder,this))}o.prototype._onSplice=function(q){var r=q.spliceResult;this._splice(r.removedItemsList,r.addedItemsList)};o.prototype._onReplace=function(t){var r=this._filtered[t.index]!==0;var s=this._filterItem.call(this._scope,t.newItem)!==false;if(!r&&!s){return}var q=this._countFiltered(0,t.index);this._filtered[t.index]=s?1:0;if(!s){this.target.tryRemove(q)}else{if(!r){this.target.tryAdd(t.newItem,q)}else{this.target.trySet(t.newItem,q)}}};o.prototype._onMove=function(s){if(this._filtered[s.fromIndex]!==0){var q,r;if(s.fromIndex<s.toIndex){q=this._countFiltered(0,s.fromIndex);r=q+this._countFiltered(s.fromIndex+1,s.toIndex-s.fromIndex)}else{r=this._countFiltered(0,s.toIndex);q=r+this._countFiltered(s.toIndex,s.fromIndex-s.toIndex)}this.target.tryMove(q,r)}b.Array.tryMove(this._filtered,s.fromIndex,s.toIndex)};o.prototype._onClear=function(q){this.target.tryClear()};o.prototype._onReorder=function(v){var s=0;var u={};for(var q=0,r=this._filtered.length;q<r;++q){if(this._filtered[q]!==0){u[v.indexArray[q]]=s++
}}b.Array.tryReorder(this._filtered,v.indexArray);var s=0;var t=new _JW.A(this.target.getLength());for(var q=0,r=this._filtered.length;q<r;++q){if(this._filtered[q]!==0){t[u[q]]=s++}}this.target.tryReorder(t)};return o})(b.AbstractArray.Filterer);c.Filterer=n;var d=(function(p){__extends(o,p);function o(r,q){p.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.clearEvent.bind(this._onClear,this))}o.prototype._onSplice=function(q){var r=q.spliceResult;this.target.trySplice(this._keys(r.getRemovedItems()),this._index(r.getAddedItems()))};o.prototype._onReplace=function(q){this.target.trySplice(this._keys([q.oldItem]),this._index([q.newItem]))};o.prototype._onClear=function(q){this.target.tryRemoveAll(this._keys(q.items))};return o})(b.AbstractArray.Indexer);c.Indexer=d;var i=(function(p){__extends(o,p);function o(r,q){p.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.moveEvent.bind(this._onMove,this));this.own(r.clearEvent.bind(this._onClear,this));this.own(r.reorderEvent.bind(this._onReorder,this))}o.prototype._onSplice=function(s){var u=s.spliceResult;var x=u.oldItems;var y=u.getRemovedItems();if(this._clearItems&&(3*y.length>2*x.length)){this._clearItems.call(this._scope,x);this._addItems(this.source.getItems(),0);return}var w=u.removedItemsList;var q=u.addedItemsList;for(var t=w.length-1;t>=0;--t){var z=w[t];this._removeItems(z.items,z.index)}for(var t=0,r=q.length;t<r;++t){var v=q[t];this._addItems(v.items,v.index)}};o.prototype._onReplace=function(q){if(this._removeItem){this._removeItem.call(this._scope,q.oldItem,q.index)}if(this._addItem){this._addItem.call(this._scope,q.newItem,q.index)}};o.prototype._onMove=function(q){if(this._removeItem){this._removeItem.call(this._scope,q.item,q.fromIndex)}if(this._addItem){this._addItem.call(this._scope,q.item,q.toIndex)}};o.prototype._onClear=function(q){this._doClearItems(q.items)};o.prototype._onReorder=function(q){this._doClearItems(q.items);this._addItems(this.source.getItems(),0)};return o})(b.AbstractArray.Inserter);c.Inserter=i;var g=(function(o){__extends(p,o);function p(r,q){o.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.clearEvent.bind(this._onClear,this))}p.prototype._onSplice=function(q){var r=q.spliceResult;this.target.trySplice(r.getRemovedItems(),r.getAddedItems())};p.prototype._onReplace=function(q){this.target.trySplice([q.oldItem],[q.newItem])};p.prototype._onClear=function(q){this.target.tryRemoveAll(q.items)};return p})(b.AbstractArray.Lister);c.Lister=g;var e=(function(o){__extends(p,o);function p(r,q){o.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.moveEvent.bind(this._onMove,this));this.own(r.clearEvent.bind(this._onClear,this));this.own(r.reorderEvent.bind(this._onReorder,this))}p.prototype._onSplice=function(u){var s=u.spliceResult;var r=s.addedItemsList;var z=[];for(var v=0,t=r.length;v<t;++v){var y=r[v];z.push(new b.AbstractArray.IndexItems(y.index,this._createItems(y.items)))}var x=this.target.trySplice(s.getRemoveParamsList(),z);var w=s.removedItemsList;var q=x.removedItemsList;for(var v=q.length-1;v>=0;--v){this._destroyItems(q[v].items,w[v].items)}};p.prototype._onReplace=function(s){var q=this._createItem.call(this._scope,s.newItem);var r=this.target.trySet(q,s.index).value;this._destroyItem.call(this._scope,r,s.oldItem)};p.prototype._onMove=function(q){this.target.tryMove(q.fromIndex,q.toIndex)};p.prototype._onClear=function(q){this._destroyItems(this.target.tryClear(),q.items)};p.prototype._onReorder=function(q){this.target.tryReorder(q.indexArray)};return p})(b.AbstractArray.Mapper);c.Mapper=e;var h=(function(o){__extends(p,o);function p(r,q){o.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.moveEvent.bind(this._onMove,this));this.own(r.clearEvent.bind(this._onClear,this));this.own(r.reorderEvent.bind(this._onReorder,this))}p.prototype._getIndexes=function(s){var q=0;var r=b.Array.map(s,function(t){var u=q;q+=t.getLength();return u},this);r.push(q);return r};p.prototype._onSplice=function(s){var v=this;var u=s.spliceResult;var q=this._getIndexes(u.oldItems);var t=b.Array.map(u.removedItemsList,function(w){return new b.AbstractArray.IndexCount(q[w.index],v._count(w.items))},this);b.Array.backEvery(u.removedItemsList,function(y){q.splice(y.index,y.items.length);var x=v._count(y.items);for(var w=y.index;w<q.length;++w){q[w]-=x}return true},this);var r=b.Array.map(u.addedItemsList,function(w){return new b.AbstractArray.IndexItems(q[w.index],v._merge(w.items))},this);this.target.trySplice(t,r)};p.prototype._onReplace=function(r){var q=this._count(this.source.getItems(),0,r.index);this.target.trySplice([new b.AbstractArray.IndexCount(q,r.oldItem.getLength())],[new b.AbstractArray.IndexItems(q,r.newItem.getItems())])};p.prototype._onMove=function(w){var u=w.item.getLength();var s=new _JW.A(this.target.getLength());var r=0;function v(z,x){for(var y=0;y<z;++y){s[r]=r+x;++r}}for(var t=0,q=Math.min(w.fromIndex,w.toIndex);t<q;++t){v(this.source.get(t).getLength(),0)}if(w.fromIndex<=w.toIndex){v(u,this._count(this.source.getItems(),w.fromIndex,w.toIndex-w.fromIndex));for(var t=w.fromIndex;t<w.toIndex;++t){v(this.source.get(t).getLength(),-u)}}else{for(var t=w.toIndex+1;t<=w.fromIndex;++t){v(this.source.get(t).getLength(),u)}v(u,-this._count(this.source.getItems(),w.toIndex+1,w.fromIndex-w.toIndex))}for(var t=Math.max(w.fromIndex,w.toIndex)+1,q=this.source.getLength();t<q;++t){v(this.source.get(t).getLength(),0)}this.target.tryReorder(s)};p.prototype._onClear=function(q){this.target.tryClear()};p.prototype._onReorder=function(s){var w=this._getIndexes(s.items);var z=this._getIndexes(this.source.getItems());var v=new _JW.A(this.target.getLength());for(var u=0,r=s.items.length;u<r;++u){var A=s.items[u];var x=w[u];var y=z[s.indexArray[u]];for(var t=0,q=A.getLength();t<q;++t){v[x+t]=y+t}}this.target.tryReorder(v)};return p})(b.AbstractArray.Merger);c.Merger=h;var h;(function(p){var o=(function(r){__extends(q,r);function q(t,s){r.call(this);this.source=t.source;this.target=t.target;this.bunch=s;this.own(s.spliceEvent.bind(this._onSplice,this));this.own(s.replaceEvent.bind(this._onReplace,this));this.own(s.moveEvent.bind(this._onMove,this));this.own(s.clearEvent.bind(this._onClear,this));this.own(s.reorderEvent.bind(this._onReorder,this))}q.prototype._getIndex=function(){var w=this.source.getItems();var u=0;for(var v=0,t=w.length;v<t;++v){var s=w[v];if(s===this.bunch){return u}u+=s.getLength()}console.warn("JW.ObservableArray.Merger object is corrupted");return 0};q.prototype._onSplice=function(u){var w=u.spliceResult;var s=this._getIndex();var v=b.Array.map(w.removedItemsList,function(x){return new b.AbstractArray.IndexCount(x.index+s,x.items.length)});var t=b.Array.map(w.addedItemsList,function(x){return new b.AbstractArray.IndexItems(x.index+s,x.items.concat())});this.target.trySplice(v,t)};q.prototype._onReplace=function(s){this.target.trySet(s.newItem,this._getIndex()+s.index)};q.prototype._onMove=function(t){var s=this._getIndex();this.target.tryMove(s+t.fromIndex,s+t.toIndex)};q.prototype._onClear=function(s){this.target.tryRemoveAll(this._getIndex(),s.items.length)};q.prototype._onReorder=function(y){var t=this._getIndex();var x=y.indexArray;var s=x.length;var w=this.target.getLength();var v=new _JW.A(w);for(var u=0;u<t;++u){v[u]=u}for(var u=0;u<s;++u){v[t+u]=t+x[u]}for(var u=t+s;u<w;++u){v[u]=u}this.target.tryReorder(v)};return q})(b.Class);p.Bunch=o})(h=c.Merger||(c.Merger={}));var f=(function(p){__extends(o,p);function o(r,q){p.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.clearEvent.bind(this._onClear,this));
if(this._change){this.own(r.changeEvent.bind(this._onChange,this))}}o.prototype._onSplice=function(s){var t=s.spliceResult;var r=t.oldItems;var q=t.getRemovedItems();if(this._clearItems&&(3*q.length>2*r.length)){this._clearItems.call(this._scope,r);this._addItems(this.source.getItems())}else{this._removeItems(q);this._addItems(t.getAddedItems())}};o.prototype._onReplace=function(q){if(this._removeItem){this._removeItem.call(this._scope,q.oldItem)}if(this._addItem){this._addItem.call(this._scope,q.newItem)}};o.prototype._onClear=function(q){this._doClearItems(q.items)};return o})(b.AbstractArray.Observer);c.Observer=f;var k=(function(o){__extends(p,o);function p(r,q){o.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.clearEvent.bind(this._onClear,this))}p.prototype._onSplice=function(q){var r=q.spliceResult;this._splice(b.Array.toSet(r.getRemovedItems()),b.Array.toSet(r.getAddedItems()))};p.prototype._onReplace=function(r){var q=this.target.keyOf(r.oldItem);this.target.trySplice([new b.AbstractArray.IndexCount(q,1)],[new b.AbstractArray.IndexItems(this.target.getLength()-1,[r.newItem])])};p.prototype._onClear=function(q){this.target.removeItems(q.items)};return p})(b.AbstractArray.Orderer);c.Orderer=k;var j=(function(o){__extends(p,o);function p(r,q){o.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.moveEvent.bind(this._onMove,this));this.own(r.clearEvent.bind(this._onClear,this));this.own(r.reorderEvent.bind(this._onReorder,this))}p.prototype._onSplice=function(u){var x=this;var w=u.spliceResult;var s=this.target.getLength();var t=s;var v=b.Array.map(w.removedItemsList,function(A){var z=A.items.length;var y=s-A.index-z;t-=z;return new b.AbstractArray.IndexCount(y,z)});v.reverse();var q=w.addedItemsList.concat();q.reverse();b.Array.each(q,function(y){t+=y.items.length});var r=b.Array.map(q,function(B){var y=B.items;var A=y.length;var z=t-B.index-A;return new b.AbstractArray.IndexItems(z,x._reverse(y))});this.target.trySplice(v,r)};p.prototype._onReplace=function(q){this.target.trySet(q.newItem,this.target.getLength()-q.index-1)};p.prototype._onMove=function(q){this.target.tryMove(this.target.getLength()-q.fromIndex-1,this.target.getLength()-q.toIndex-1)};p.prototype._onClear=function(q){this.target.tryClear()};p.prototype._onReorder=function(u){var r=u.indexArray;var t=r.length;var q=new _JW.A(r.length);for(var s=0;s<t;++s){q[t-s-1]=t-r[s]-1}this.target.tryReorder(q)};return p})(b.AbstractArray.Reverser);c.Reverser=j;var l=(function(p){__extends(o,p);function o(r,q){p.call(this,r,q);this.own(r.spliceEvent.bind(this._onSplice,this));this.own(r.replaceEvent.bind(this._onReplace,this));this.own(r.clearEvent.bind(this._onClear,this))}o.prototype._onSplice=function(q){var r=q.spliceResult;this._splice(r.getRemovedItems(),r.getAddedItems())};o.prototype._onReplace=function(q){this._splice([q.oldItem],[q.newItem])};o.prototype._onClear=function(q){this._splice(q.items,[])};return o})(b.AbstractArray.SorterComparing);c.SorterComparing=l})(a=b.ObservableArray||(b.ObservableArray={}))})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(f,e){d.call(this,f,e);this.spliceEvent=new b.Event();this.reindexEvent=new b.Event();this.clearEvent=new b.Event();this.changeEvent=new b.Event();this.length=new b.Property(this.getLength())}c.prototype.ownItems=function(){d.prototype.ownItems.call(this);return this};c.prototype.destroyObject=function(){this.changeEvent.destroy();this.clearEvent.destroy();this.reindexEvent.destroy();this.spliceEvent.destroy();this.length.destroy();d.prototype.destroyObject.call(this)};c.prototype.trySet=function(j,h){var e=this._trySet(j,h);if(e===undefined){return}var f={};var i=e.value;if(i!==undefined){f[h]=i}var g={};g[h]=j;var k={removedItems:f,addedItems:g};this.length.set(this.getLength());this.spliceEvent.trigger({sender:this,spliceResult:k});this.changeEvent.trigger({sender:this});if(i!==undefined&&this._ownsItems){i.destroy()}return e};c.prototype.setAll=function(e){this.trySetAll(e)};c.prototype.trySetKey=function(f,g){var e=d.prototype.trySetKey.call(this,f,g);if(e===undefined){return}this.reindexEvent.trigger({sender:this,keyMap:b.Map.single(f,g)});this.changeEvent.trigger({sender:this});return e};c.prototype.tryRemove=function(e){var f=this._tryRemove(e);if(f===undefined){return}var g={addedItems:{},removedItems:b.Map.single(e,f)};this.length.set(this.getLength());this.spliceEvent.trigger({sender:this,spliceResult:g});this.changeEvent.trigger({sender:this});if(this._ownsItems){f.destroy()}return f};c.prototype.removeAll=function(e){this.tryRemoveAll(e)};c.prototype.trySplice=function(e,f){var g=this._trySplice(e,f);if(g===undefined){return}this.length.set(this.getLength());this.spliceEvent.trigger({sender:this,spliceResult:g});this.changeEvent.trigger({sender:this});if(this._ownsItems){b.Array.backEvery(b.Map.toArray(g.removedItems),b.destroyForcibly)}return g};c.prototype.tryClear=function(){var e=this._tryClear();if(e===undefined){return}this.length.set(0);this.clearEvent.trigger({sender:this,items:e});this.changeEvent.trigger({sender:this});if(this._ownsItems){b.Array.backEvery(b.Map.toArray(e),b.destroyForcibly)}return e};c.prototype.tryReindex=function(f){var e=d.prototype.tryReindex.call(this,f);if(e===undefined){return}this.reindexEvent.trigger({sender:this,keyMap:e});this.changeEvent.trigger({sender:this});return e};c.prototype.$$toSortedComparing=function(h,g,f){var e=new b.ObservableArray();e.own(this.createSorterComparing({target:e,compare:h,scope:g||this,order:f}));return e};c.prototype.$$index=function(g,f){var e=new c();e.own(this.createIndexer({target:e,getKey:g,scope:f||this}));return e};c.prototype.$$toArray=function(){var e=new b.ObservableArray();e.own(this.createOrderer({target:e}));return e};c.prototype.$$toSet=function(){var e=new b.ObservableSet();e.own(this.createLister({target:e}));return e};c.prototype.$$filter=function(g,f){var e=new c();e.own(this.createFilterer({target:e,filterItem:g,scope:f||this}));return e};c.prototype.$$count=function(g,f){var e=new b.Property(0);e.own(this.createCounter({target:e,filterItem:g,scope:f||this}));return e};c.prototype.$$mapValues=function(g,f){var e=new c();e.own(this.createMapper({target:e,createItem:g,scope:f||this}));return e};c.prototype.$$mapObjects=function(g,f){var e=new c();e.own(this.createMapper({target:e,createItem:g,destroyItem:b.destroy,scope:f||this}));return e};c.prototype.createEmpty=function(){return new c()};c.prototype.createEmptyArray=function(){return new b.ObservableArray()};c.prototype.createEmptyMap=function(){return new c()};c.prototype.createEmptySet=function(){return new b.ObservableSet()};c.prototype.createMapper=function(e){return new c.Mapper(this,e)};c.prototype.createFilterer=function(e){return new c.Filterer(this,e)};c.prototype.createCounter=function(e){return new c.Counter(this,e)};c.prototype.createObserver=function(e){return new c.Observer(this,e)};c.prototype.createOrderer=function(e){return new c.Orderer(this,e)};c.prototype.createSorterComparing=function(e){return new c.SorterComparing(this,e)};c.prototype.createIndexer=function(e){return new c.Indexer(this,e)};c.prototype.createLister=function(e){return new c.Lister(this,e)};c.prototype.createInserter=function(e){return new c.Inserter(this,e)};return c})(b.AbstractMap);b.ObservableMap=a;var a;(function(c){var k=(function(m){__extends(n,m);function n(p,o){m.call(this,p,o);this.own(p.spliceEvent.bind(this._onSplice,this));this.own(p.clearEvent.bind(this._onClear,this))}n.prototype._onSplice=function(o){var p=o.spliceResult;this.target.set(this.target.get()-b.Map.count(p.removedItems,this._filterItem,this._scope)+b.Map.count(p.addedItems,this._filterItem,this._scope))
};n.prototype._onClear=function(o){this.target.set(0)};return n})(b.AbstractMap.Counter);c.Counter=k;var l=(function(n){__extends(m,n);function m(p,o){n.call(this,p,o);this.own(p.spliceEvent.bind(this._onSplice,this));this.own(p.reindexEvent.bind(this._onReindex,this));this.own(p.clearEvent.bind(this._onClear,this))}m.prototype._onSplice=function(o){var p=o.spliceResult;this.target.trySplice(b.Map.getKeys(p.removedItems),b.Map.filter(p.addedItems,this._filterItem,this._scope))};m.prototype._onReindex=function(o){this.target.tryReindex(o.keyMap)};m.prototype._onClear=function(o){this.target.tryRemoveAll(b.Map.getKeys(o.items))};return m})(b.AbstractMap.Filterer);c.Filterer=l;var d=(function(n){__extends(m,n);function m(p,o){n.call(this,p,o);this.own(p.spliceEvent.bind(this._onSplice,this));this.own(p.clearEvent.bind(this._onClear,this))}m.prototype._onSplice=function(o){var p=o.spliceResult;this.target.trySplice(this._keys(b.Map.toArray(p.removedItems)),this._index(b.Map.toArray(p.addedItems)))};m.prototype._onClear=function(o){this.target.tryRemoveAll(this._keys(b.Map.toArray(o.items)))};return m})(b.AbstractMap.Indexer);c.Indexer=d;var h=(function(n){__extends(m,n);function m(p,o){n.call(this,p,o);this.own(p.spliceEvent.bind(this._onSplice,this));this.own(p.reindexEvent.bind(this._onReindex,this));this.own(p.clearEvent.bind(this._onClear,this))}m.prototype._onSplice=function(o){var p=o.spliceResult;this._removeItems(p.removedItems);this._addItems(p.addedItems)};m.prototype._onReindex=function(r){var s=r.keyMap;for(var p in s){var q=s[p];var o=this.source.get(q);if(this._removeItem){this._removeItem.call(this._scope,p,o)}if(this._addItem){this._addItem.call(this._scope,o,q)}}};m.prototype._onClear=function(o){this._doClearItems(o.items)};return m})(b.AbstractMap.Inserter);c.Inserter=h;var f=(function(m){__extends(n,m);function n(p,o){m.call(this,p,o);this.own(p.spliceEvent.bind(this._onSplice,this));this.own(p.clearEvent.bind(this._onClear,this))}n.prototype._onSplice=function(o){var p=o.spliceResult;this.target.trySplice(b.Map.toArray(p.removedItems),b.Map.toArray(p.addedItems))};n.prototype._onClear=function(o){this.target.tryRemoveAll(b.Map.toArray(o.items))};return n})(b.AbstractMap.Lister);c.Lister=f;var e=(function(m){__extends(n,m);function n(p,o){m.call(this,p,o);this.own(p.spliceEvent.bind(this._onSplice,this));this.own(p.reindexEvent.bind(this._onReindex,this));this.own(p.clearEvent.bind(this._onClear,this))}n.prototype._onSplice=function(r){var q=r.spliceResult;var s=q.removedItems;var p=q.addedItems;var o=this.target.trySplice(b.Map.getRemovedKeys(s,p),this._createItems(p));if(o!==undefined){this._destroyItems(o.removedItems,s)}};n.prototype._onReindex=function(o){this.target.tryReindex(o.keyMap)};n.prototype._onClear=function(p){var o=p.items;this._destroyItems(this.target.tryRemoveAll(b.Map.getKeys(o)),o)};return n})(b.AbstractMap.Mapper);c.Mapper=e;var g=(function(n){__extends(m,n);function m(p,o){n.call(this,p,o);this.own(p.spliceEvent.bind(this._onSplice,this));this.own(p.clearEvent.bind(this._onClear,this));if(this._change){this.own(p.changeEvent.bind(this._onChange,this))}}m.prototype._onSplice=function(o){var p=o.spliceResult;this._removeItems(b.Map.toArray(p.removedItems));this._addItems(b.Map.toArray(p.addedItems))};m.prototype._onClear=function(o){this._doClearItems(b.Map.toArray(o.items))};return m})(b.AbstractMap.Observer);c.Observer=g;var i=(function(m){__extends(n,m);function n(p,o){m.call(this,p,o);this.own(p.spliceEvent.bind(this._onSplice,this));this.own(p.clearEvent.bind(this._onClear,this))}n.prototype._onSplice=function(o){var p=o.spliceResult;this._splice(b.Map.toSet(p.removedItems),b.Map.toSet(p.addedItems))};n.prototype._onClear=function(o){this.target.removeItems(b.Map.toArray(o.items))};return n})(b.AbstractMap.Orderer);c.Orderer=i;var j=(function(n){__extends(m,n);function m(p,o){n.call(this,p,o);this.own(p.spliceEvent.bind(this._onSplice,this));this.own(p.clearEvent.bind(this._onClear,this))}m.prototype._onSplice=function(o){var p=o.spliceResult;this._splice(b.Map.toArray(p.removedItems),b.Map.toArray(p.addedItems))};m.prototype._onClear=function(o){this._splice(b.Map.toArray(o.items),[])};return m})(b.AbstractMap.SorterComparing);c.SorterComparing=j})(a=b.ObservableMap||(b.ObservableMap={}))})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(f,e){d.call(this,f,e);this.spliceEvent=new b.Event();this.clearEvent=new b.Event();this.changeEvent=new b.Event();this.length=new b.Property(this.getLength())}c.prototype.ownItems=function(){d.prototype.ownItems.call(this);return this};c.prototype.destroyObject=function(){this.changeEvent.destroy();this.clearEvent.destroy();this.spliceEvent.destroy();this.length.destroy();d.prototype.destroyObject.call(this)};c.prototype.tryClear=function(){var e=this._tryClear();if(e===undefined){return}this.length.set(0);this.clearEvent.trigger({sender:this,items:e});this.changeEvent.trigger({sender:this});if(this._ownsItems){b.Array.backEvery(e,b.destroyForcibly)}return e};c.prototype.trySplice=function(e,f){var g=this._trySplice(e,f);if(g===undefined){return}this.length.set(this.getLength());this.spliceEvent.trigger({sender:this,spliceResult:g});this.changeEvent.trigger({sender:this});if(this._ownsItems){b.Array.backEvery(g.removedItems,b.destroyForcibly)}return g};c.prototype.$$toSortedComparing=function(h,g,f){var e=new b.ObservableArray();e.own(this.createSorterComparing({target:e,compare:h,scope:g||this,order:f}));return e};c.prototype.$$index=function(g,f){var e=new b.ObservableMap();e.own(this.createIndexer({target:e,getKey:g,scope:f||this}));return e};c.prototype.$$toArray=function(){var e=new b.ObservableArray();e.own(this.createOrderer({target:e}));return e};c.prototype.$$toSet=function(){var e=new c();e.own(this.createLister({target:e}));return e};c.prototype.$$filter=function(g,f){var e=new c();e.own(this.createFilterer({target:e,filterItem:g,scope:f||this}));return e};c.prototype.$$count=function(g,f){var e=new b.Property(0);e.own(this.createCounter({target:e,filterItem:g,scope:f||this}));return e};c.prototype.$$mapValues=function(g,f){var e=new c();e.own(this.createMapper({target:e,createItem:g,scope:f||this}));return e};c.prototype.$$mapObjects=function(g,f){var e=new c();e.own(this.createMapper({target:e,createItem:g,destroyItem:b.destroy,scope:f||this}));return e};c.prototype.createEmpty=function(){return new c()};c.prototype.createEmptyArray=function(){return new b.ObservableArray()};c.prototype.createEmptyMap=function(){return new b.ObservableMap()};c.prototype.createEmptySet=function(){return new c()};c.prototype.createMapper=function(e){return new c.Mapper(this,e)};c.prototype.createFilterer=function(e){return new c.Filterer(this,e)};c.prototype.createCounter=function(e){return new c.Counter(this,e)};c.prototype.createObserver=function(e){return new c.Observer(this,e)};c.prototype.createOrderer=function(e){return new c.Orderer(this,e)};c.prototype.createSorterComparing=function(e){return new c.SorterComparing(this,e)};c.prototype.createIndexer=function(e){return new c.Indexer(this,e)};c.prototype.createLister=function(e){return new c.Lister(this,e)};return c})(b.AbstractSet);b.ObservableSet=a;var a;(function(k){var i=(function(l){__extends(m,l);function m(o,n){l.call(this,o,n);this.own(o.spliceEvent.bind(this._onSplice,this));this.own(o.clearEvent.bind(this._onClear,this))}m.prototype._onSplice=function(n){var o=n.spliceResult;this.target.set(this.target.get()-b.Array.count(o.removedItems,this._filterItem,this._scope)+b.Array.count(o.addedItems,this._filterItem,this._scope))};m.prototype._onClear=function(n){this.target.set(0)};return m})(b.AbstractSet.Counter);k.Counter=i;var j=(function(m){__extends(l,m);function l(o,n){m.call(this,o,n);
this.own(o.spliceEvent.bind(this._onSplice,this));this.own(o.clearEvent.bind(this._onClear,this))}l.prototype._onSplice=function(n){var o=n.spliceResult;this.target.trySplice(o.removedItems,b.Array.filter(o.addedItems,this._filterItem,this._scope))};l.prototype._onClear=function(n){this.target.tryRemoveAll(n.items)};return l})(b.AbstractSet.Filterer);k.Filterer=j;var c=(function(m){__extends(l,m);function l(o,n){m.call(this,o,n);this.own(o.spliceEvent.bind(this._onSplice,this));this.own(o.clearEvent.bind(this._onClear,this))}l.prototype._onSplice=function(n){var o=n.spliceResult;this.target.trySplice(this._keys(o.removedItems),this._index(o.addedItems))};l.prototype._onClear=function(n){this.target.tryRemoveAll(this._keys(n.items))};return l})(b.AbstractSet.Indexer);k.Indexer=c;var e=(function(l){__extends(m,l);function m(o,n){l.call(this,o,n);this.own(o.spliceEvent.bind(this._onSplice,this));this.own(o.clearEvent.bind(this._onClear,this))}m.prototype._onSplice=function(n){var o=n.spliceResult;this.target.trySplice(o.removedItems,o.addedItems)};m.prototype._onClear=function(n){this.target.tryRemoveAll(n.items)};return m})(b.AbstractSet.Lister);k.Lister=e;var d=(function(l){__extends(m,l);function m(o,n){l.call(this,o,n);this.own(o.spliceEvent.bind(this._onSplice,this));this.own(o.clearEvent.bind(this._onClear,this))}m.prototype._onSplice=function(o){var q=o.spliceResult;var p=q.removedItems;var n=q.addedItems;this.target.trySplice(this._getItems(p),this._createItems(n));this._destroyItems(p)};m.prototype._onClear=function(o){var n=o.items;this.target.tryRemoveAll(this._getItems(n));this._destroyItems(n)};return m})(b.AbstractSet.Mapper);k.Mapper=d;var f=(function(m){__extends(l,m);function l(o,n){m.call(this,o,n);this.own(o.spliceEvent.bind(this._onSplice,this));this.own(o.clearEvent.bind(this._onClear,this));if(this._change){this.own(o.changeEvent.bind(this._onChange,this))}}l.prototype._onSplice=function(n){var o=n.spliceResult;this._removeItems(o.removedItems);this._addItems(o.addedItems)};l.prototype._onClear=function(n){this._doClearItems(n.items)};return l})(b.AbstractSet.Observer);k.Observer=f;var g=(function(l){__extends(m,l);function m(o,n){l.call(this,o,n);this.own(o.spliceEvent.bind(this._onSplice,this));this.own(o.clearEvent.bind(this._onClear,this))}m.prototype._onSplice=function(n){var o=n.spliceResult;this._splice(b.Array.toSet(o.removedItems),b.Array.toSet(o.addedItems))};m.prototype._onClear=function(n){this.target.removeItems(n.items)};return m})(b.AbstractSet.Orderer);k.Orderer=g;var h=(function(m){__extends(l,m);function l(o,n){m.call(this,o,n);this.own(o.spliceEvent.bind(this._onSplice,this));this.own(o.clearEvent.bind(this._onClear,this))}l.prototype._onSplice=function(n){var o=n.spliceResult;this._splice(o.removedItems,o.addedItems)};l.prototype._onClear=function(n){this._splice(n.items,[])};return l})(b.AbstractSet.SorterComparing);k.SorterComparing=h})(a=b.ObservableSet||(b.ObservableSet={}))})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(a){var b=(function(d){__extends(c,d);function c(f,e){d.call(this,f,e)}c.prototype.ownItems=function(){d.prototype.ownItems.call(this);return this};c.prototype.createEmpty=function(){return new c()};c.prototype.createEmptyArray=function(){return new a.Array()};c.prototype.createEmptyMap=function(){return new a.Map()};c.prototype.createEmptySet=function(){return new c()};c.getLength=function(g){var f=0;for(var e in g){++f}return f};c.isEmpty=function(f){for(var e in f){return false}return true};c.getFirst=function(f){for(var e in f){return f[e]}};c.contains=function(f,e){return f.hasOwnProperty(_JW.S(e._iid))};c.containsItem=function(f,e){return f.hasOwnProperty(_JW.S(e._iid))};c.every=function(h,g,e){e=e||h;for(var f in h){if(g.call(e,h[f])===false){return false}}return true};c.some=function(g,f,e){return !c.every(g,function(h){return f.call(this,h)===false},e)};c.each=function(g,f,e){c.every(g,function(h){f.call(this,h);return true},e)};c.search=function(h,g,f){var e;c.every(h,function(i){if(g.call(this,i)!==false){e=i;return false}return true},f);return e};c.toSorted=function(i,h,f,e){h=h||function(j){return j};e=e||1;var g=[];c.every(i,function(j){g.push([j,h.call(this,j)]);return true},f);g.sort(function(j,k){return e*a.cmp(j[1],k[1])});return a.Array.map(g,function(j){return j[0]})};c.$toSorted=function(h,g,f,e){return new a.Array(c.toSorted(h,g,f,e),true)};c.toSortedComparing=function(i,h,g,e){h=h||a.cmp;g=g||i;e=e||1;var f=c.toArray(i);f.sort(function(j,k){return e*h.call(g,j,k)});return f};c.$toSortedComparing=function(h,g,f,e){return new a.Array(c.toSortedComparing(h,g,f,e),true)};c.index=function(h,g,f){var e={};c.every(h,function(j){var i=g.call(this,j);if(i!=null){e[i]=j}return true},f);return e};c.$index=function(g,f,e){return new a.Map(c.index(g,f,e),true)};c.filter=function(h,g,f){var e={};c.every(h,function(i){if(g.call(this,i)!==false){e[i._iid]=i}return true},f);return e};c.$filter=function(g,f,e){return new c(c.filter(g,f,e),true)};c.count=function(h,g,f){var e=0;c.every(h,function(i){if(g.call(this,i)!==false){++e}return true},f);return e};c.$count=function(g,f,e){return new a.Property(c.count(g,f,e))};c.map=function(h,g,f){var e={};c.every(h,function(i){c.tryAdd(e,g.call(this,i));return true},f);return e};c.$map=function(g,f,e){return new c(c.map(g,f,e),true)};c.toArray=function(g){var e=new _JW.A(c.getLength(g));var f=0;c.every(g,function(h){e[f++]=h;return true});return e};c.$toArray=function(e){return new a.Array(c.toArray(e),true)};c.toSet=function(f){var e={};c.every(f,function(g){c.add(e,g);return true});return e};c.$toSet=function(e){return new c(c.toSet(e),true)};c.asArray=function(e){return c.toArray(e)};c.$asArray=function(e){return c.$toArray(e)};c.asSet=function(e){return e};c.$asSet=function(e){return new c(e,true)};c.add=function(f,e){return c.tryAdd(f,e)!==undefined};c.tryAdd=function(g,e){var f=_JW.S(e._iid);if(g.hasOwnProperty(f)){return}g[f]=e;return true};c.addAll=function(g,f){var e=c.tryAddAll(g,f);return(e!==undefined)?e:[]};c.$addAll=function(f,e){return new a.Array(c.addAll(f,e),true)};c.tryAddAll=function(k,f){var h=[];for(var g=0,e=f.length;g<e;++g){var j=f[g];if(c.tryAdd(k,j)){h.push(j)}}if(h.length!==0){return h}};c.remove=function(f,e){return c.tryRemove(f,e)!==undefined};c.tryRemove=function(g,e){var f=_JW.S(e._iid);if(!g.hasOwnProperty(f)){return}delete g[f];return true};c.removeItem=function(f,e){c.tryRemove(f,e)};c.removeAll=function(g,f){var e=c.tryRemoveAll(g,f);return(e!==undefined)?e:[]};c.$removeAll=function(f,e){return new a.Array(c.removeAll(f,e),true)};c.tryRemoveAll=function(k,g){var f=[];for(var h=0,e=g.length;h<e;++h){var j=g[h];if(c.tryRemove(k,j)){f.push(j)}}if(f.length!==0){return f}};c.removeItems=function(f,e){c.tryRemoveAll(f,e)};c.clear=function(f){var e=c.tryClear(f);return(e!==undefined)?e:[]};c.$clear=function(e){return new a.Array(c.clear(e),true)};c.tryClear=function(f){var e=c.toArray(f);if(!e.length){return}c.tryRemoveAll(f,e);return e};c.splice=function(h,e,f){var g=c.trySplice(h,e,f);return(g!==undefined)?g:{addedItems:[],removedItems:[]}};c.trySplice=function(h,e,f){var g=new c(f);e=a.Array.filter(e,function(i){return !g.contains(i)});e=c.tryRemoveAll(h,e);f=c.tryAddAll(h,f);if((e!==undefined)||(f!==undefined)){return{removedItems:e||[],addedItems:f||[]}}};c.detectSplice=function(j,i){var e=[];var h=[];var f=a.Array.index(i,a.byField("_iid"));for(var g in j){if(!f.hasOwnProperty(g)){e.push(j[g])}}for(var g in f){if(!j.hasOwnProperty(g)){h.push(f[g])}}if((e.length!==0)||(h.length!==0)){return{removedItems:e,addedItems:h}}};c.performSplice=function(g,e){var f=c.detectSplice(g,e);if(f!==undefined){c.trySplice(g,f.removedItems,f.addedItems)}};c.equal=function(e,h){if(c.getLength(e)!==h.length){return false}for(var g=0,f=h.length;
g<f;++g){if(!e.hasOwnProperty(_JW.S(h[g]._iid))){return false}}return true};c.single=function(f){var e={};e[f._iid]=f;return e};return c})(a.AbstractSet);a.Set=b})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(a){var b=(function(c){__extends(d,c);function d(f,e){c.call(this);this.source=f;e=e||{};this._targetCreated=e.target==null;this.target=this._targetCreated?new a.Property():e.target;this._update();this.own(f.changeEvent.bind(this._update,this))}d.prototype.destroyObject=function(){if(this._targetCreated){this.target.destroy()}this.source=null;this.target=null;c.prototype.destroyObject.call(this)};d.prototype._update=function(){this.target.set(this.source.get())};return d})(a.Class);a.Copier=b})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(b){var a=(function(d){__extends(c,d);function c(f,h,g,e){d.call(this);this.sources=f;this.callback=h;this.scope=g;e=e||{};this.scope=g||this;this._targetCreated=e.target==null;this.target=this._targetCreated?new b.Property():e.target;this.update();b.Array.each(f,this.watch,this)}c.prototype.destroyObject=function(){if(this._targetCreated){this.target.destroy()}this.sources=null;this.target=null;this.callback=null;this.scope=null;d.prototype.destroyObject.call(this)};c.prototype.bind=function(e){this.own(e.bind(this.update,this));return this};c.prototype.watch=function(e){return this.bind(e.changeEvent)};c.prototype.update=function(){var e=b.Array.map(this.sources,b.byMethod("get"));this.target.set(this.callback.apply(this.scope,e))};return c})(b.Class);b.Functor=a})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(a){var b=(function(c){__extends(d,c);function d(f,e){c.call(this);this.sources=f;this._createValue=e.createValue;this._destroyValue=e.destroyValue;this._scope=e.scope||this;this._targetCreated=e.target==null;this.target=this._targetCreated?new a.Property():e.target;this._acceptNull=e.acceptNull||false;this._sourceValues=null;this._targetValue=null;this.update();a.Array.each(f,this.watch,this)}d.prototype.destroyObject=function(){var e=this.target.get();if(e===this._targetValue){this.target.set(null)}this._done();if(this._targetCreated){this.target.destroy()}this.sources=null;this._createValue=null;this._destroyValue=null;this._scope=null;this.target=null;this._sourceValues=null;this._targetValue=null;c.prototype.destroyObject.call(this)};d.prototype.bind=function(e){this.own(e.bind(this.update,this));return this};d.prototype.watch=function(e){return this.bind(e.changeEvent)};d.prototype.update=function(){var e=a.Array.map(this.sources,a.byMethod("get"));var f;if(this._acceptNull||a.Array.every(e,a.isSet)){f=this._createValue.apply(this._scope,e)}else{f=null;e=null}this.target.set(f);this._done();this._targetValue=f;this._sourceValues=e};d.prototype._done=function(){if(this._destroyValue&&this._sourceValues){this._destroyValue.apply(this._scope,[this._targetValue].concat(this._sourceValues))}};return d})(a.Class);a.Mapper=b})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(a){var b=(function(c){__extends(d,c);function d(e){if(e===void 0){e=null}c.call(this);this._value=e;this._ownsValue=false;this._copier=null;this.changeEvent=this.own(new a.Event())}d.prototype.destroyObject=function(){this.bindTo();if(this._ownsValue&&(this._value!=null)){this._value.destroy()}c.prototype.destroyObject.call(this)};d.prototype.get=function(){return this._value};d.prototype.set=function(f){if(f===undefined){f=null}var e=this._value;if(e===f){return}this._value=f;this.changeEvent.trigger({sender:this,value:f,oldValue:e});if(this._ownsValue&&(e!=null)){e.destroy()}};d.prototype.ownValue=function(){this._ownsValue=true;return this};d.prototype.bindTo=function(e){if(this._copier!=null){this._copier.destroy();this._copier=null}if(e!=null){this._copier=new a.Copier(e,{target:this})}};d.prototype.map=function(f,e){return(this._value==null)?null:f.call(e||this,this._value)};d.prototype.$map=function(f,e){return new d(this.map(f,e))};d.prototype.$$mapValue=function(g,f){var e=new d();e.own(new a.Mapper([this],{target:e,createValue:g,scope:f||this}));return e};d.prototype.$$mapObject=function(g,f){var e=new d();e.own(new a.Mapper([this],{target:e,createValue:g,destroyValue:a.destroy,scope:f||this}));return e};return d})(a.Class);a.Property=b})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(a){var b=(function(c){__extends(d,c);function d(f,e){c.call(this);this.sources=f;e=e||{};this._init=e.init;this._done=e.done;this._scope=e.scope||this;this._acceptNull=e.acceptNull||false;this._sourceValues=null;this._doInit();a.Array.each(f,this.watch,this)}d.prototype.destroyObject=function(){this._doDone();this.sources=null;this._init=null;this._done=null;this._scope=null;this._sourceValues=null;c.prototype.destroyObject.call(this)};d.prototype.bind=function(e){this.own(e.bind(this.update,this));return this};d.prototype.watch=function(e){return this.bind(e.changeEvent)};d.prototype.update=function(){this._doDone();this._doInit()};d.prototype._doInit=function(){var e=a.Array.map(this.sources,a.byMethod("get"));this._sourceValues=(this._acceptNull||a.Array.every(e,a.isSet))?e:null;if(this._sourceValues&&this._init){this._init.apply(this._scope,this._sourceValues)}};d.prototype._doDone=function(){if(this._sourceValues&&this._done){this._done.apply(this._scope,this._sourceValues)}this._sourceValues=null};return d})(a.Class);a.Switcher=b})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(a){var b=(function(c){__extends(d,c);function d(e,g,f){c.call(this);this.sources=e;this.callback=g;this.scope=f;this.scope=f||this;this.update();a.Array.each(e,this.watch,this)}d.prototype.bind=function(e){this.own(e.bind(this.update,this));return this};d.prototype.watch=function(e){return this.bind(e.changeEvent)};d.prototype.update=function(){var e=a.Array.map(this.sources,a.byMethod("get"));this.callback.apply(this.scope,e)};return d})(a.Class);a.Updater=b})(JW||(JW={}));var JW;(function(b){var a=(function(){function c(d){if(d===void 0){d="id"}this.idField=d;this.items={};this.itemArray=[]}c.prototype.registerItem=function(d){this.items[d[this.idField]]=d;this.itemArray.push(d)};c.prototype.getId=function(d){return d[this.idField]};return c})();b.Registry=a})(JW||(JW={}));var JW;(function(b){var a;(function(h){function e(p){return _JW.S(p).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}h.htmlEncode=e;function o(p){return _JW.S(p).replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}h.htmlDecode=o;function l(r){r=_JW.S(r);var p=[];var q=0;while(true){var s=r.indexOf("<script",q);if(s===-1){break}p.push(r.substr(q,s-q));q=r.indexOf("<\/script>",s)+9;if(q===-1){return p.join("")}}p.push(r.substr(q));return p.join("")}h.removeScripts=l;function i(r,q,p){r=_JW.S(r);if(r.length<=q){return r}p=b.defn(p,"...");return r.substr(0,q-p.length)+p}h.ellipsis=i;function n(t,s,r){t=_JW.S(t);
var p=[];s-=t.length;for(var q=0;q<s;++q){p.push(r)}p.push(t);return p.join("")}h.prepend=n;function f(p){return _JW.S(p).charAt(0).toUpperCase()+p.substr(1)}h.capitalize=f;function m(p){return _JW.S(p).replace(/-([a-z])/ig,g)}h.camel=m;function j(p){return _JW.S(p).replace(/([A-Z])/g,c)}h.hyphen=j;function d(p){return _JW.S(p).replace(/^\s*/,"").replace(/\s*$/,"")}h.trim=d;function k(r){if(b.isArray(r)){var p=[];for(var q=0;q<r.length;++q){p.push.apply(p,k(r[q]))}return p}if(typeof r==="string"){r=d(r);if(r===""){return[]}return r.split(/\s+/)}return[]}h.parseClass=k;function g(q,p){return p.toUpperCase()}function c(q,p){return"-"+p.toLowerCase()}})(a=b.String||(b.String={}))})(JW||(JW={}));var __extends=(this&&this.__extends)||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}f.prototype=a===null?Object.create(a):(c.prototype=a.prototype,new c())};var JW;(function(d){var a=(function(f){__extends(e,f);function e(j,h,g){f.call(this);if((h!=null)&&(typeof h==="object")){j=d.inScope(j,h)}else{if(typeof h==="number"){g=h}}var i=this._init;this._timeout=i(j,g)}e.prototype.destroyObject=function(){var g=this._done;g(this._timeout);f.prototype.destroyObject.call(this)};return e})(d.Class);d.BaseTimeout=a;var c=(function(f){__extends(e,f);function e(){f.apply(this,arguments)}return e})(a);d.Timeout=c;c.prototype._init=setTimeout;c.prototype._done=clearTimeout;var b=(function(f){__extends(e,f);function e(){f.apply(this,arguments)}return e})(a);d.Interval=b;b.prototype._init=setInterval;b.prototype._done=clearInterval})(JW||(JW={}));JW.ClassUtil={_iid:0,_fnTest:/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,extend:function(e,c,a){a=a||{};var d=function(){};d.prototype=c.prototype;e.prototype=new d();e.prototype.constructor=e;e.superclass=c.prototype;e._super=c;for(var b in a){e.prototype[b]=JW.ClassUtil.extendMethod(a[b],c.prototype[b])}e.extend=function(g){var h=function(){e.apply(this,arguments)};JW.extend(h,e,g);return h};return e},extendMethod:function(b,a){if((typeof a!=="function")||(typeof b!=="function")||b.superclass||!JW.ClassUtil._fnTest.test(b)){return b}return function(){var d=this._super;this._super=a;var c=b.apply(this,arguments);this._super=d;return c}}};JW.extend=JW.ClassUtil.extend;JW.Class.extend=function(a){var b=function(){JW.Class.apply(this,arguments)};JW.extend(b,JW.Class,a);return b};